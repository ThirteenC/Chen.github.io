(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3276e130"],{"07ac":function(e,t,i){var n=i("23e7"),a=i("6f53").values;n({target:"Object",stat:!0},{values:function(e){return a(e)}})},"09f4":function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),Math.easeInOutQuad=function(e,t,i,n){return e/=n/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function a(e,t){t?document.querySelector(t).scrollTop=e:(document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e)}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,i,r){var s=o(),c=e-s,l=20,u=0;t="undefined"===typeof t?500:t;var d=function e(){u+=l;var o=Math.easeInOutQuad(u,s,c,t);a(o,i),u<t?n(e):r&&"function"===typeof r&&r()};d()}},"15fd":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));i("a4d3"),i("b64b");function n(e,t){if(null==e)return{};var i,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(a[i]=e[i]);return a}function a(e,t){if(null==e)return{};var i,a,o=n(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)i=r[a],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}},"2b4a":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{attrs:{inline:!0,model:e.search}},[i("el-form-item",{attrs:{label:"名称"}},[i("el-input",{attrs:{placeholder:"名称",clearable:""},on:{clear:function(t){return e.getList(1)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(1)}},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),i("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(t){return e.getList(1)}}},[e._v(" "+e._s(e.$t("table.search"))+" ")]),i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onAddOrUpdate()}}},[e._v(" 本地"+e._s(e.$t("table.add"))+" ")])],1)],1),i("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.onHandleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"我的海报",name:"my",disabled:e.loading}},[0===e.list.length?i("el-empty",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{description:"暂无数据"}}):i("div",{staticClass:"all-card"},e._l(e.list,(function(t,n){return i("el-card",{key:n,staticClass:"box-card",attrs:{shadow:"hover"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"ellipsis"},[e._v(" "+e._s(t.name)+" ")])]),t.url?i("div",{staticClass:"card-content"},[i("el-image",{staticClass:"image-item",attrs:{src:t.url&&e.domin+t.url,"preview-src-list":[t.url&&e.domin+t.url]}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1):i("div",{staticClass:"card-content"},[i("el-empty",{attrs:{description:"请添加内容"}})],1),i("div",{staticClass:"card-footer"},[i("section",{on:{click:function(i){return e.onAddOrUpdate(t)}}},[i("i",{staticClass:"el-icon-edit-outline",staticStyle:{color:"#409eff"}})]),i("section",{on:{click:function(i){return e.onDelete(t)}}},[i("i",{staticClass:"el-icon-delete",staticStyle:{color:"#f56c6c"}})])])])})),1)],1)],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pages.total>0,expression:"pages.total > 0"}],attrs:{total:e.pages.total,page:e.pages.current,limit:e.pages.limit},on:{"update:page":function(t){return e.$set(e.pages,"current",t)},"update:limit":function(t){return e.$set(e.pages,"limit",t)},pagination:function(t){return e.getList()}}}),e.addOrUpdateVisible?i("add-or-update",{ref:"addOrUpdate",on:{refreshList:function(t){return e.getList()}}}):e._e(),e.imageViewer?i("el-image-viewer",{attrs:{"on-close":e.closeViewer,"url-list":e.imageViewerList}}):e._e()],1)},a=[],o=i("5530"),r=(i("ac1f"),i("841c"),i("d3b7"),i("d81d"),i("b0c0"),i("99af"),i("333d")),s=i("15fd"),c=i("b775"),l=["id"];function u(e){return c["a"].get("poster",{params:e})}function d(e){return c["a"].get("/poster/template",{params:e})}function f(e){var t=e.id,i=Object(s["a"])(e,l),n="POST",a="/poster";return t>0&&(n="PUT",a+="/".concat(t),i.id=t),Object(c["a"])({url:a,method:n,data:i})}function m(e){return c["a"].delete("/poster/".concat(e))}var p=i("5f87"),v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.form.id&&!e.form.stock?e.$t("table.edit"):e.$t("table.add")+"到我的海报",visible:e.visible},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"海报",prop:"icon"}},[i("custom-upload",{attrs:{"class-name":"avatar-uploader"},on:{handleBeforeUpload:e.beforeAvatarUpload,handleSuccess:e.handleAvatarSuccess}},[e.form.url?i("img",{staticClass:"avatar",attrs:{src:e.domin+e.form.url}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),i("div",{staticClass:"notice"},[e._v(" 注意：建议海报尺寸 608px * 744px ")])],1),i("el-form-item",{attrs:{label:"海报名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"海报名称",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"排序",prop:"sort"}},[i("el-input-number",{attrs:{min:0,placeholder:"排序"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.onFormSubmit()}}},[e._v(" "+e._s(e.$t("table.confirm"))+" ")]),i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")])],1)],1)},g=[],h=(i("caad"),i("a15b"),i("0eef")),b={name:"AddOrUpdate",components:{CustomUpload:h["a"]},data:function(){return{visible:!1,btnLoading:!1,domin:Object(p["c"])(p["a"]),form:{id:0,url:"",name:"",sort:0},agentList:[],roleOptions:[],rules:{url:[{required:!0,message:"请上传海报",trigger:["blur","change"]}],name:[{required:!0,message:"海报名称不能为空",trigger:["blur","change"]}]}}},methods:{init:function(e){this.visible=!0,e&&(this.form=Object.assign({},e),e.stock&&(this.form.id=0))},onFormSubmit:function(){var e=this;this.$refs["form"].validate((function(t){t&&(e.btnLoading=!0,f(e.form).then((function(t){var i=t.msg;e.form.stock?e.$message.success("已成功添加到 我的海报库"):e.$message.success(i),e.visible=!1,e.$emit("refreshList")})).catch((function(){e.btnLoading=!1})))}))},onClose:function(){this.btnLoading=!1,this.$reset()},handleAvatarSuccess:function(e,t){this.form.url=e.name},beforeAvatarUpload:function(e,t){var i=["image/jpeg","image/jpg","image/png","image/gif"],n=e.size/1024/1024<20;return i.includes(e.type)?n?void t(!0):(this.$message.error("上传图片大小不能超过 20M"),void t(!1)):(this.$message.error("上传图片只能是 "+i.join(",")+" 格式!"),void t(!1))}}},w=b,O=(i("e3ea"),i("2877")),k=Object(O["a"])(w,v,g,!1,null,"08ac2a04",null),y=k.exports,L=i("08a9"),j={name:"Agreement",components:{Pagination:r["a"],AddOrUpdate:y,ElImageViewer:L["a"]},data:function(){return{loading:!1,imageViewer:!1,addOrUpdateVisible:!1,domin:Object(p["c"])(p["a"]),activeName:"my",imageViewerList:[],list:[],search:{name:""},pages:{total:0,limit:20,current:1}}},created:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pages.current,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.loading){this.loading=i,1===t&&(this.pages.current=t),this.list=[];var n=u(Object(o["a"])(Object(o["a"])({page:t},this.search),{},{limit:this.pages.limit}));"stock"===this.activeName&&(n=d(Object(o["a"])(Object(o["a"])({page:t},this.search),{},{limit:this.pages.limit}))),n.then((function(t){0===t.code&&(e.list=t.data.data.map((function(t){return"stock"===e.activeName?Object.assign(t,{stock:!0}):Object.assign(t,{stock:!1})})),e.pages.total=t.data.total)})).catch((function(){})).finally((function(){e.loading=!1}))}},onHandleClick:function(){this.getList(1)},onDelete:function(e){var t=this,i=e.name,n=e.id;this.$confirm("确定对(#".concat(n,")[").concat(i,"]进行[删除]操作?"),"删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((function(){m(n).then((function(e){var i=e.msg,n=void 0===i?"删除成功":i;t.$message.success(n),t.init()})).catch((function(){}))})).catch((function(){}))},onAddOrUpdate:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate&&t.$refs.addOrUpdate.init(e)}))},onPreview:function(e){this.imageViewerList=[this.domin+e.url],this.imageViewer=!0},closeViewer:function(){this.imageViewer=!1}}},$=j,x=(i("4d3d"),Object(O["a"])($,n,a,!1,null,"22ab3314",null));t["default"]=x.exports},3123:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("b775");function a(){return n["a"].get("/token")}},3578:function(e,t,i){},"4d3d":function(e,t,i){"use strict";i("3578")},"6f53":function(e,t,i){var n=i("83ab"),a=i("e330"),o=i("df75"),r=i("fc6a"),s=i("d1e7").f,c=a(s),l=a([].push),u=function(e){return function(t){var i,a=r(t),s=o(a),u=s.length,d=0,f=[];while(u>d)i=s[d++],n&&!c(a,i)||l(f,e?[i,a[i]]:a[i]);return f}};e.exports={entries:u(!0),values:u(!1)}},"72bc":function(e,t,i){"use strict";var n=i("d4ec"),a=i("bee2"),o=(i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("b0c0"),i("ac1f"),i("1276"),i("b680"),function(){function e(t,i){return Object(n["a"])(this,e),this.video=document.createElement("video"),this.video.preload="metadata",this.video.src=URL.createObjectURL(t),this.init(t,i)}return Object(a["a"])(e,[{key:"init",value:function(e,t){var i=this;return new Promise((function(n){var a=i.fileLengthFormat(e.size,t),o=i.getFileType(e.name);"mp4"===o?i.video.onloadedmetadata=function(){window.URL.revokeObjectURL(i.video.src);var e=i.video.duration;n({fileSize:a,duration:e,type:o,height:i.video.videoHeight,width:i.video.videoWidth})}:n({fileSize:a,duration:0,type:o,height:i.video.videoHeight,width:i.video.videoWidth})}))}},{key:"getFileType",value:function(e){var t=e.split("."),i="";return void 0!==t&&(t.length<=1&&e.indexOf("=")>-1?(console.log("输入是文件地址：",t),!1):(i=t[t.length-1],i=i.toLowerCase(),i))}},{key:"fileLengthFormat",value:function(e,t){var i,n=e/1024;if(n>1e3)return this.fileLengthFormat(n,++t);switch(t){case 1:i=n.toFixed(2);break;case 2:i=n.toFixed(2);break;case 3:i=n.toFixed(2);break;case 4:i=n.toFixed(2);break}return+i}}]),e}());t["a"]=o},d419:function(e,t,i){},e3ea:function(e,t,i){"use strict";i("d419")}}]);