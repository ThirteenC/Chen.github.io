(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a2d0ad8"],{"09f4":function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,i,a){return e/=a/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function n(e,t){t?document.querySelector(t).scrollTop=e:(document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e)}function r(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,i,o){var l=r(),s=e-l,c=20,u=0;t="undefined"===typeof t?500:t;var d=function e(){u+=c;var r=Math.easeInOutQuad(u,l,s,t);n(r,i),u<t?a(e):o&&"function"===typeof o&&o()};d()}},"15fd":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));i("a4d3"),i("b64b");function a(e,t){if(null==e)return{};var i,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)i=r[a],t.indexOf(i)>=0||(n[i]=e[i]);return n}function n(e,t){if(null==e)return{};var i,n,r=a(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}},3123:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var a=i("b775");function n(){return a["a"].get("/token")}},3800:function(e,t,i){"use strict";i.d(t,"h",(function(){return a})),i.d(t,"g",(function(){return n})),i.d(t,"j",(function(){return r})),i.d(t,"b",(function(){return o})),i.d(t,"l",(function(){return l})),i.d(t,"d",(function(){return s})),i.d(t,"k",(function(){return c})),i.d(t,"f",(function(){return u})),i.d(t,"e",(function(){return d})),i.d(t,"c",(function(){return m})),i.d(t,"a",(function(){return f})),i.d(t,"i",(function(){return p}));var a=[{label:"全部",value:""}],n=[{label:"全部",value:""},{label:"微信",value:"wxpay"},{label:"京东",value:"jdpay"},{label:"支付宝",value:"alipay"},{label:"银行卡",value:"bank"}],r=[{label:"全部",value:""},{label:"上架",value:0},{label:"下架",value:1}],o=[{label:"全部",value:""},{label:"通过",value:1,type:"success"},{label:"失败",value:2,type:"danger"}],l=[{label:"全部",value:""},{label:"否",value:0},{label:"是",value:1}],s=[{label:"一次性",value:"once",type:"warning"},{label:"长期",value:"long",type:"success"},{label:"指定藏品",value:"appoint",type:"primary"}],c=[{label:"全部",value:""},{label:"常规藏品",value:0,type:"primary"},{label:"盲盒藏品",value:1,type:"warning"},{label:"空投藏品",value:2,type:"primary"},{label:"合成藏品",value:3,type:"success"},{label:"资格券",value:5,type:"danger"},{label:"活动藏品",value:7,type:"danger"}],u=[{label:"全部",value:""},{label:"藏品订单",value:"goods",type:"primary"},{label:"盲盒订单",value:"box",type:"warning"}],d=[{label:"全部",value:""},{label:"待付款",value:0,type:"warning"},{label:"待发放",value:1,type:"primary"},{label:"已完成",value:2,type:"success"},{label:"已关闭",value:3,type:"info"},{label:"异常订单",value:4,type:"danger"}],m=[{label:"普通",value:0,type:"info"},{label:"3D",value:1,type:"primary"},{label:"视频",value:2,type:"warning"}],f=[{label:"指定藏品",value:"goods",type:"primary"},{label:"指定专区",value:"issuer",type:"warning"}],p={shortcuts:[{text:"最近24小时",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-864e5),e.$emit("pick",[i,t])}},{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]}},"43ab":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{attrs:{inline:!0,model:e.search}},[i("el-form-item",{attrs:{label:"活动标题"}},[i("el-input",{attrs:{placeholder:"活动标题",clearable:""},on:{clear:function(t){return e.getList(1)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(1)}},model:{value:e.search.keywords,callback:function(t){e.$set(e.search,"keywords",t)},expression:"search.keywords"}})],1),i("el-form-item",{attrs:{label:"时间"}},[i("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},on:{change:e.onChangeDateRange},model:{value:e.dateRangeValue,callback:function(t){e.dateRangeValue=t},expression:"dateRangeValue"}})],1),i("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(t){return e.getList(1)}}},[e._v(" "+e._s(e.$t("table.search"))+" ")]),i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onAddOrUpdate()}}},[e._v(" "+e._s(e.$t("table.add"))+" ")])],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.list}},[i("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),i("el-table-column",{attrs:{width:"120",label:"封面图","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",{staticClass:"info-wrapper"},[i("el-image",{staticClass:"image-item",attrs:{src:a.cover.filename&&e.domin+a.cover.filename,"preview-src-list":[e.domin+a.cover.filename]}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1)]}}])}),i("el-table-column",{attrs:{"min-width":"200",label:"活动标题","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(i.title)+" ")]}}])}),i("el-table-column",{attrs:{"min-width":"180",label:"限量","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",[e._v(" 库存："+e._s(a.limit_num||0)+" ")]),i("div",[e._v(" 用户合成限量："+e._s(a.user_limit_num||0)+" ")]),i("div",[e._v(" 剩余："+e._s(a.limit_num-a.synthesis_num)+" ")])]}}])}),i("el-table-column",{attrs:{width:"170",label:"合成时间范围","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",[e._v(" 开始："+e._s(a.start_time)+" ")]),i("div",[e._v(" 结束："+e._s(a.end_time)+" ")])]}}])}),i("el-table-column",{attrs:{width:"60",prop:"sort",label:"排序",align:"center"}}),i("el-table-column",{attrs:{width:"70",label:"上架状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(e._f("paraphrase")(i.status,e.statusOptions))+" ")]}}])}),i("el-table-column",{attrs:{width:"140",prop:"created_at",label:"创建时间","header-align":"center"}}),i("el-table-column",{attrs:{label:"操作",width:"220",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button-group",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onAddOrUpdate(a)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.onRecordLog(a)}}},[e._v("合成记录")]),i("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.onDelete(a)}}},[e._v("删除")])],1)]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pages.total>0,expression:"pages.total > 0"}],attrs:{total:e.pages.total,page:e.pages.current,limit:e.pages.limit},on:{"update:page":function(t){return e.$set(e.pages,"current",t)},"update:limit":function(t){return e.$set(e.pages,"limit",t)},pagination:function(t){return e.getList()}}}),e.addOrUpdateVisible?i("add-or-update",{ref:"addOrUpdate",on:{refreshList:function(t){return e.getList()}}}):e._e(),e.recordVisible?i("synthetic-record-log",{ref:"recordLog",on:{refreshList:function(t){return e.getList()}}}):e._e()],1)},n=[],r=i("5530"),o=(i("fb6a"),i("d3b7"),i("ac1f"),i("841c"),i("15fd")),l=i("b775"),s=["id"];function c(e){return l["a"].get("/synthesis",{params:e})}function u(e){var t=e.id,i=Object(o["a"])(e,s),a="POST",n="/synthesis";return t>0&&(a="PUT",n+="/".concat(t),i.id=t),Object(l["a"])({url:n,method:a,data:i})}function d(e){return l["a"].delete("/synthesis/".concat(e))}function m(e){return l["a"].get("/synthesis/synthesis/list",{params:e})}function f(e){return l["a"].get("/synthesis/formula/list",{params:e})}function p(e,t){return l["a"].get("/synthesis/".concat(e,"/log"),{params:t})}var g=i("5f87"),v=i("3800"),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{width:"800px",top:"30px",title:e.form.id?e.$t("table.edit"):e.$t("table.add"),visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"封面图",prop:"cover.filename"}},[i("custom-upload",{attrs:{"class-name":"avatar-uploader","ref-name":"cover"},on:{handleBeforeUpload:e.beforeAvatarUpload,handleSuccess:e.handleCoverSuccess}},[i("img",{directives:[{name:"show",rawName:"v-show",value:e.form.cover.filename,expression:"form.cover.filename"}],staticClass:"avatar",attrs:{src:e.form.cover.filename&&e.domin+e.form.cover.filename}}),i("i",{directives:[{name:"show",rawName:"v-show",value:!e.form.cover.filename,expression:"!form.cover.filename"}],staticClass:"el-icon-plus avatar-uploader-icon"})]),i("div",{staticClass:"notice"},[e._v("注意：建议藏品图片尺寸 750*750px")])],1),i("el-form-item",{attrs:{label:"活动标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"活动标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"合成藏品",prop:"goods_id"}},[i("el-select",{attrs:{filterable:"",clearable:"",disabled:e.form.formula.length>0},on:{change:e.onChangeGood},model:{value:e.form.goods_id,callback:function(t){e.$set(e.form,"goods_id",t)},expression:"form.goods_id"}},e._l(e.synthesisOptions,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[i("span",[e._v("#"+e._s(t.value))]),i("el-image",{staticClass:"good-img",attrs:{fit:"cover",src:t.image&&e.domin+t.image}}),i("span",[e._v(" "+e._s(t.label)+" ")])],1)})),1)],1),i("el-form-item",{attrs:{label:"合成时间",prop:"dateRangeValue"}},[i("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},on:{change:e.onChangeDateRange},model:{value:e.form.dateRangeValue,callback:function(t){e.$set(e.form,"dateRangeValue",t)},expression:"form.dateRangeValue"}})],1),i("el-form-item",{attrs:{label:"合成条件",prop:"formula"}},[i("div",{staticClass:"timeline-box"},[i("el-timeline",e._l(e.form.formula,(function(t,a){return i("el-timeline-item",{directives:[{name:"show",rawName:"v-show",value:t.goods_id.length>0,expression:"item.goods_id.length > 0"}],key:a,attrs:{placement:"top"}},[i("div",{staticStyle:{"margin-bottom":"5px"}},[i("el-form",{attrs:{inline:!0,"label-width":"70px","label-position":"left"}},[i("el-form-item",{attrs:{label:"条件"+(a+1)}}),i("el-form-item",{attrs:{label:"是否销毁"}},[i("el-radio-group",{model:{value:e.form.formula[a].is_destroy,callback:function(t){e.$set(e.form.formula[a],"is_destroy",t)},expression:"form.formula[index].is_destroy"}},[i("el-radio",{attrs:{label:0}},[e._v("否")]),i("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1),i("el-form-item",{attrs:{label:"需要份数"}},[i("el-input-number",{staticStyle:{width:"100px"},attrs:{precision:0,min:1,"controls-position":"right"},model:{value:e.form.formula[a].num,callback:function(t){e.$set(e.form.formula[a],"num",t)},expression:"form.formula[index].num"}})],1)],1)],1),i("el-card",{attrs:{shadow:"hover"}},[i("i",{staticClass:"el-icon-close close",on:{click:function(i){return e.onDelCard(a,t)}}}),e._l(t.goods_id,(function(t,n){return i("div",{key:n,staticClass:"good-item"},[i("el-image",{staticClass:"good-img",attrs:{src:e._f("filterFormula")(t,e.formulaAllOptions,"image"),fit:"cover"}}),i("span",[i("el-tag",{attrs:{type:e._f("paraphrase")(e._f("filterFormula")(t,e.formulaAllOptions,"type"),e.typeOptions,"value","type")}},[e._v(" "+e._s(e._f("paraphrase")(e._f("filterFormula")(t,e.formulaAllOptions,"type"),e.typeOptions))+" ")]),e._v(" "+e._s(e._f("filterFormula")(t,e.formulaAllOptions,"label"))+" ")],1),i("i",{staticClass:"el-icon-delete del-good",on:{click:function(i){return e.onDelGood(a,n,t)}}})],1)}))],2)],1)})),1)],1),e.addFormulaShow?i("div",[i("el-select",{staticClass:"select-input",attrs:{"popper-class":"popover-box",multiple:"",filterable:"",clearable:""},model:{value:e.formulaSelect,callback:function(t){e.formulaSelect=t},expression:"formulaSelect"}},e._l(e.formulaOptions,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[i("el-image",{staticClass:"good-img",attrs:{fit:"cover",src:t.image}}),i("span",{staticStyle:{"margin-left":"10px"}},[i("el-tag",{attrs:{type:e._f("paraphrase")(t.type,e.typeOptions,"value","type")}},[e._v(" "+e._s(e._f("paraphrase")(t.type,e.typeOptions))+" ")]),e._v(" "+e._s(t.label)+" ")],1)],1)})),1),i("div",{staticClass:"add-box"},[i("el-button",{attrs:{type:"primary",plain:""},on:{click:e.onFormula}},[e._v(" 确定 ")]),i("el-button",{on:{click:e.onCancelFormula}},[e._v("取消")])],1)],1):i("el-button",{attrs:{type:"primary",plain:""},on:{click:e.onAddFormulaShow}},[e._v(" + 条件 ")])],1),i("el-form-item",{attrs:{label:"库存",prop:"limit_num"}},[i("el-input-number",{attrs:{precision:0,min:0},model:{value:e.form.limit_num,callback:function(t){e.$set(e.form,"limit_num",t)},expression:"form.limit_num"}})],1),i("el-form-item",{attrs:{label:"排序",prop:"sort"}},[i("el-input-number",{attrs:{min:0,precision:0},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),i("el-form-item",{attrs:{label:"是否上架"}},[i("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[i("el-radio",{attrs:{label:0}},[e._v("是")]),i("el-radio",{attrs:{label:1}},[e._v("否")])],1)],1),i("el-form-item",{attrs:{label:"用户合成限量",prop:"user_limit_num"}},[i("el-input-number",{attrs:{precision:0,min:0},model:{value:e.form.user_limit_num,callback:function(t){e.$set(e.form,"user_limit_num",t)},expression:"form.user_limit_num"}})],1),i("el-form-item",{attrs:{label:"合成规则说明",prop:"intro"}},[i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.onTinymce(e.form)}}},[e._v(" 点击编辑 ")])],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.onFormSubmit()}}},[e._v(" "+e._s(e.$t("table.confirm"))+" ")]),i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")])],1)],1),e.editTinymceVisible?i("edit-tinymce",{ref:"editTinymce",on:{info:e.onInfo}}):e._e()],1)},b=[],y=i("b85c"),_=i("c7eb"),w=i("1da1"),k=(i("7db0"),i("99af"),i("3ca3"),i("ddb0"),i("e9c4"),i("13d5"),i("4de4"),i("caad"),i("2532"),i("d81d"),i("b0c0"),i("a434"),i("a15b"),i("2b3d"),i("9861"),i("0eef")),O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{top:"30px",width:"1000px","append-to-body":"",title:"规则说明",visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"规则说明",prop:"info"}},[e.visible?i("tinymce",{attrs:{height:400},model:{value:e.form.info,callback:function(t){e.$set(e.form,"info",t)},expression:"form.info"}}):e._e()],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onFormSubmit()}}},[e._v(" "+e._s(e.$t("table.confirm"))+" ")]),i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")])],1)],1)},x=[],$=(i("5319"),i("8256")),C={name:"EditTinymce",components:{Tinymce:$["a"]},data:function(){return{visible:!1,form:{info:""},rules:{info:[{required:!0,message:"请输入内容",trigger:["blur","change"]}]}}},methods:{init:function(e){this.visible=!0,e&&(this.form.info=e.intro)},onFormSubmit:function(){var e=this;this.$refs["form"].validate((function(t){t&&(e.form.info=e.form.info.replace(/crossorigin=\"anonymous\"/g,""),e.$emit("info",e.form.info),e.visible=!1)}))},onClose:function(){this.$reset()}}},S=C,L=i("2877"),j=Object(L["a"])(S,O,x,!1,null,"f4387cf0",null),T=j.exports,F=i("ed08"),A={name:"AddOrUpdate",components:{CustomUpload:k["a"],EditTinymce:T},filters:{filterFormula:function(e,t,i){var a;return null===(a=t.find((function(t){return t.value===e})))||void 0===a?void 0:a[i]}},data:function(){return{domin:Object(g["c"])(g["a"]),pickerOptions:v["i"],visible:!1,btnLoading:!1,editTinymceVisible:!1,addFormulaShow:!1,typeOptions:v["k"].concat([{label:"空投藏品",value:2,type:"danger"}]),currentName:"",synthesisOptions:[],formulaOptions:[],formulaAllOptions:[],formulaSelect:[],form:{id:0,title:"",cover:{filename:"",height:0,width:0,mime:""},sort:0,status:0,goods_id:"",user_limit_num:"",dateRangeValue:[],start_time:"",end_time:"",formula:[],limit_num:"",intro:""},rules:{"cover.filename":[{required:!0,message:"不能为空",trigger:["blur","change"]}],title:[{required:!0,message:"不能为空",trigger:["blur","change"]}],dateRangeValue:[{required:!0,message:"请选择时间",trigger:["blur","change"]}],formula:[{required:!0,message:"不能为空",trigger:["blur"]}],limit_num:[{required:!0,message:"不能为空",trigger:["blur","change"]}],user_limit_num:[{required:!0,message:"不能为空",trigger:["blur","change"]}],detail:[{required:!0,message:"不能为空",trigger:["blur","change"]}],goods_id:[{required:!0,message:"请选择",trigger:["blur","change"]}],sort:[{required:!0,message:"不能为空",trigger:["blur","change"]}]}}},methods:{init:function(e){var t=this;this.visible=!0,Promise.all([this.getSynthesisList(),this.getFormulaList()]).then((function(){if(e){t.form=Object.assign(JSON.parse(JSON.stringify(e)),{dateRangeValue:[Object(F["e"])(e.start_time),Object(F["e"])(e.end_time)]}),t.onChangeGood(e.goods_id);var i=e.formula.reduce((function(e,t){return e.concat(t.goods_id)}),[]);t.formulaOptions=t.formulaOptions.filter((function(e){return!i.includes(e.value)}))}}))},getSynthesisList:function(){var e=this;return Object(w["a"])(Object(_["a"])().mark((function t(){return Object(_["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m().then((function(t){e.synthesisOptions=t.data.map((function(e){return{label:e.name,value:e.id,image:e.images&&e.images[0]}}))})).catch((function(){}));case 2:case"end":return t.stop()}}),t)})))()},getFormulaList:function(){var e=this;return Object(w["a"])(Object(_["a"])().mark((function t(){return Object(_["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f().then((function(t){e.formulaOptions=t.data.map((function(t){return{label:t.name,value:t.id,type:t.type,image:t.images&&e.domin+t.images[0]}})),e.formulaAllOptions=e.formulaOptions})).catch((function(){}));case 2:case"end":return t.stop()}}),t)})))()},onFormula:function(){var e=this;this.formulaSelect.length>0&&(this.form.formula.push({goods_id:this.formulaSelect,is_destroy:0,num:1}),this.formulaOptions=this.formulaOptions.filter((function(t){return!e.formulaSelect.includes(t.value)}))),this.onCancelFormula()},onCancelFormula:function(){this.formulaSelect=[],this.addFormulaShow=!1},onDelGood:function(e,t,i){this.form.formula[e].goods_id.splice(t,1),0===this.form.formula[e].goods_id.length&&this.form.formula.splice(e,1);var a=this.formulaAllOptions.find((function(e){return e.value===i}));a&&this.formulaOptions.push(a)},onDelCard:function(e,t){this.form.formula.splice(e,1);var i,a=Object(y["a"])(t.goods_id);try{for(a.s();!(i=a.n()).done;){var n=i.value,r=this.formulaAllOptions.find((function(e){return e.value===n}));r&&this.formulaOptions.push(r)}}catch(o){a.e(o)}finally{a.f()}},onAddFormulaShow:function(){return this.form.goods_id?10===this.form.formula.length?(this.$message.warning("最多添加10个条件"),!1):void(this.formulaOptions.length>0?this.addFormulaShow=!0:this.$message.warning("已无可选项")):(this.$message.warning("请先选择`合成藏品`"),!1)},onChangeDateRange:function(e){Array.isArray(e)?(this.form.start_time=e[0],this.form.end_time=e[1]):this.form.start_time=this.form.end_time=""},onChangeGood:function(e){this.formulaOptions=e?this.formulaAllOptions.filter((function(t){return!(t.value===e)})):this.formulaAllOptions},onFormSubmit:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var i=e.form.formula.reduce((function(e,t){return e.concat(t.goods_id)}),[]);if(i.includes(e.form.goods_id))return e.$message.error("合成条件中不能有合成藏品"),!1;e.btnLoading=!0,u(e.form).then((function(t){var i=t.msg;e.$message.success(i),e.visible=!1,e.$emit("refreshList")})).catch((function(){e.btnLoading=!1}))}}))},onClose:function(){this.$reset()},onTinymce:function(e){var t=this;this.editTinymceVisible=!0,this.$nextTick((function(){t.$refs.editTinymce&&t.$refs.editTinymce.init(e)}))},onInfo:function(e){this.form.intro=e},handleCoverSuccess:function(e,t){this.form[this.currentName].filename=e.name},beforeAvatarUpload:function(e,t,i){var a=this,n=["image/jpeg","image/jpg","image/png","image/gif"],r=e.size/1024/1024<20;return n.includes(e.type)?r?(new Promise((function(t,i){var a=window.URL||window.webkitURL,n=new Image;n.onload=function(){t({width:n.width,height:n.height})},n.onerror=function(){i()},n.src=a.createObjectURL(e)})).then((function(e){a.form.cover.width=e.width,a.form.cover.height=e.height})).catch((function(){})),this.form.cover.mime=e.type,this.currentName=i,void t(!0)):(this.$message.error("上传图片大小不能超过 20M"),void t(!1)):(this.$message.error("上传图片只能是 "+n.join(",")+" 格式!"),void t(!1))}}},R=A,U=(i("515c"),Object(L["a"])(R,h,b,!1,null,"0fcd9772",null)),D=U.exports,V=i("333d"),q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{staticClass:"custom-dialog",attrs:{width:"1200px",top:"30px",title:"合成记录",visible:e.visible},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.list}},[i("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),i("el-table-column",{attrs:{label:"用户信息","min-width":"200","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-avatar",{staticStyle:{"vertical-align":"top"},attrs:{icon:"el-icon-user-solid",src:a.user.avatar?e.domin+a.user.avatar:""}}),i("div",{staticStyle:{display:"inline-block","margin-left":"5px"}},[i("div",[e._v(" #"+e._s(a.user.id||"")+" "),i("el-divider",{attrs:{direction:"vertical"}}),e._v(" "+e._s(a.user.name||"")+" ")],1),i("div",[e._v("电话："+e._s(a.user.phone||""))]),i("div")])]}}])}),i("el-table-column",{attrs:{"min-width":"240",label:"合成信息","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",{staticClass:"info-wrapper"},[i("el-image",{staticClass:"image-item",attrs:{src:a.goods.images[0]&&e.domin+a.goods.images[0],"preview-src-list":[e.domin+a.goods.images[0]]}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])]),i("div",{staticStyle:{"margin-left":"10px"}},[i("div",[e._v("#"+e._s(a.goods.id||""))]),i("div",[e._v("藏品编号："+e._s(a.goods.serial||""))]),i("div",[e._v("藏品名称："+e._s(a.goods.name||""))])])],1)]}}])}),i("el-table-column",{attrs:{"min-width":"200",label:"信息","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("div",[e._v("HASH："+e._s(a.hash||""))]),i("div",[e._v("链上标识："+e._s(a.identification||"-"))])]}}])}),i("el-table-column",{attrs:{label:"创建时间",width:"140","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(i.created_at)+" ")]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pages.total>0,expression:"pages.total > 0"}],attrs:{"auto-scroll-dom":".custom-dialog",total:e.pages.total,page:e.pages.current,limit:e.pages.limit},on:{"update:page":function(t){return e.$set(e.pages,"current",t)},"update:limit":function(t){return e.$set(e.pages,"limit",t)},pagination:function(t){return e.getList()}}})],1)],1)},N=[],E={name:"SyntheticRecordLog",components:{Pagination:V["a"]},data:function(){return{visible:!1,loading:!1,list:[],domin:Object(g["c"])(g["a"]),pages:{total:0,limit:20,current:1},id:0}},methods:{init:function(e){this.id=e.id,this.visible=!0,this.getList()},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pages.current,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loading||(this.loading=i,1===t&&(this.pages.current=t),p(this.id,{page:t,limit:this.pages.limit}).then((function(t){e.list=t.data.data,e.pages.total=t.data.total})).catch((function(){})).finally((function(){e.loading=!1})))},onClose:function(){this.$reset("data",!1)}}},P=E,H=(i("9172"),Object(L["a"])(P,q,N,!1,null,"e23a25a0",null)),I=H.exports,M={name:"Synthetic",components:{SyntheticRecordLog:I,AddOrUpdate:D,Pagination:V["a"]},data:function(){return{domin:Object(g["c"])(g["a"]),loading:!1,pickerOptions:v["i"],statusOptions:v["j"].slice(1),dateRangeValue:[],list:[],pages:{total:0,limit:20,current:1},search:{start_time:"",end_time:"",keywords:""},addOrUpdateVisible:!1,recordVisible:!1}},created:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pages.current,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loading||(this.loading=i,1===t&&(this.pages.current=t),c(Object(r["a"])(Object(r["a"])({page:t},this.search),{},{limit:this.pages.limit})).then((function(t){e.list=t.data.data,e.pages.total=t.data.total})).catch((function(){})).finally((function(){e.loading=!1})))},onDelete:function(e){var t=this;this.$confirm("确定对合成活动[(#".concat(e.id,")]进行[删除]操作?"),"删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",cancelButtonClass:"btn-custom-cancel"}).then((function(){d(e.id).then((function(e){var i=e.msg,a=void 0===i?"删除成功":i;t.$message.success(a),t.init()})).catch((function(){t.$message.error("删除失败")}))})).catch((function(){}))},onChangeDateRange:function(e){Array.isArray(e)?(this.search.start_time=e[0],this.search.end_time=e[1]):(this.search.start_time=this.search.end_time="",this.getList(1))},onAddOrUpdate:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate&&t.$refs.addOrUpdate.init(e)}))},onRecordLog:function(e){var t=this;this.recordVisible=!0,this.$nextTick((function(){t.$refs.recordLog&&t.$refs.recordLog.init(e)}))}}},z=M,G=(i("66ca"),Object(L["a"])(z,a,n,!1,null,"44e7ae42",null));t["default"]=G.exports},"515c":function(e,t,i){"use strict";i("d756")},"66ca":function(e,t,i){"use strict";i("db00")},"72bc":function(e,t,i){"use strict";var a=i("d4ec"),n=i("bee2"),r=(i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("b0c0"),i("ac1f"),i("1276"),i("b680"),function(){function e(t,i){return Object(a["a"])(this,e),this.video=document.createElement("video"),this.video.preload="metadata",this.video.src=URL.createObjectURL(t),this.init(t,i)}return Object(n["a"])(e,[{key:"init",value:function(e,t){var i=this;return new Promise((function(a){var n=i.fileLengthFormat(e.size,t),r=i.getFileType(e.name);"mp4"===r?i.video.onloadedmetadata=function(){window.URL.revokeObjectURL(i.video.src);var e=i.video.duration;a({fileSize:n,duration:e,type:r,height:i.video.videoHeight,width:i.video.videoWidth})}:a({fileSize:n,duration:0,type:r,height:i.video.videoHeight,width:i.video.videoWidth})}))}},{key:"getFileType",value:function(e){var t=e.split("."),i="";return void 0!==t&&(t.length<=1&&e.indexOf("=")>-1?(console.log("输入是文件地址：",t),!1):(i=t[t.length-1],i=i.toLowerCase(),i))}},{key:"fileLengthFormat",value:function(e,t){var i,a=e/1024;if(a>1e3)return this.fileLengthFormat(a,++t);switch(t){case 1:i=a.toFixed(2);break;case 2:i=a.toFixed(2);break;case 3:i=a.toFixed(2);break;case 4:i=a.toFixed(2);break}return+i}}]),e}());t["a"]=r},"7db0":function(e,t,i){"use strict";var a=i("23e7"),n=i("b727").find,r=i("44d2"),o="find",l=!0;o in[]&&Array(1)[o]((function(){l=!1})),a({target:"Array",proto:!0,forced:l},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r(o)},9172:function(e,t,i){"use strict";i("e61f")},d756:function(e,t,i){},db00:function(e,t,i){},e61f:function(e,t,i){}}]);