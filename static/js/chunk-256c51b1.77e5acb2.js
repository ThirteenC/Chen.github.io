(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-256c51b1"],{"15fd":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("a4d3"),n("b64b");function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function a(e,t){if(null==e)return{};var n,a,i=r(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},"1f27":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return s}));var r=n("15fd"),a=n("b775"),i=["id"];function o(e){return a["a"].get("/menus",{params:e})}function l(e){var t=e.id,n=Object(r["a"])(e,i),o="POST",l="/menus";return t>0&&(o="PUT",l+="/".concat(t),n.id=t),Object(a["a"])({url:l,method:o,data:n})}function s(e){return a["a"].delete("/menus/".concat(e))}},"30f4":function(e,t,n){},"45a6":function(e,t,n){"use strict";n("6318")},6318:function(e,t,n){},b48d:function(e,t,n){"use strict";n("30f4")},f833:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-form",{attrs:{inline:!0,model:e.search}},[n("el-form-item",{attrs:{label:"权限名称"}},[n("el-input",{attrs:{placeholder:"权限名称",clearable:""},on:{clear:function(t){return e.getList(1)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(1)}},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),n("el-form-item",{attrs:{label:"权限别名"}},[n("el-input",{attrs:{placeholder:"权限别名",clearable:""},on:{clear:function(t){return e.getList(1)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(1)}},model:{value:e.search.alias,callback:function(t){e.$set(e.search,"alias",t)},expression:"search.alias"}})],1),n("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(t){return e.getList(1)}}},[e._v(" "+e._s(e.$t("table.search"))+" ")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onAddOrUpdate()}}},[e._v(" "+e._s(e.$t("table.add"))+" ")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"","highlight-current-row":"","row-key":"id","tree-props":{children:"children"},data:e.list}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"180",align:"center"}}),n("el-table-column",{attrs:{prop:"name",label:"权限名称",align:"center"}}),n("el-table-column",{attrs:{prop:"alias",label:"权限别名",width:"120",align:"center"}}),n("el-table-column",{attrs:{prop:"icon",label:"权限图标",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.icon?n("svg-icon",{attrs:{"icon-class":r.icon}}):e._e()]}}])}),n("el-table-column",{attrs:{prop:"url",label:"跳转地址",align:"center"}}),n("el-table-column",{attrs:{prop:"type",label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-tag",{attrs:{type:r.type?"success":""}},[e._v(e._s(r.type?"菜单":"目录"))])]}}])}),n("el-table-column",{attrs:{prop:"show",label:"是否显示",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(" "+e._s(n.show?"是":"否")+" ")]}}])}),n("el-table-column",{attrs:{prop:"sort",label:"排序",width:"80",align:"center"}}),n("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[["whisper","assist","renew","coupons"].includes(r.alias)?e._e():n("div",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onAddOrUpdate(e.lists,r)}}},[e._v("编辑")]),n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.onDelete(r)}}},[e._v("删除")])],1)]}}])})],1),e.addOrUpdateVisible?n("add-or-update",{ref:"addOrUpdate",on:{refreshList:function(t){return e.getList()}}}):e._e()],1)},a=[],i=n("5530"),o=(n("d3b7"),n("ac1f"),n("841c"),n("b0c0"),n("99af"),n("1f27")),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.form.id?e.$t("table.edit"):e.$t("table.add"),visible:e.visible},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"类型",prop:"type"}},[n("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[n("el-radio",{attrs:{label:0}},[e._v("目录")]),n("el-radio",{attrs:{label:1}},[e._v("菜单")]),e._e()],1)],1),n("el-form-item",{attrs:{label:e.typeMaps[e.form.type]+"名称",prop:"name"}},[n("el-input",{attrs:{placeholder:e.typeMaps[e.form.type]+"名称："+e.typeMaps[e.form.type]+"管理",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:e.typeMaps[e.form.type]+"别名",prop:"alias"}},[n("el-input",{attrs:{placeholder:e.typeMaps[e.form.type]+"别名：menu",clearable:""},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),1===e.form.type?n("el-form-item",{attrs:{label:"跳转地址",prop:"url"}},[n("el-input",{attrs:{type:"url",placeholder:"跳转地址：menu",clearable:""},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1):e._e(),2!==e.form.type?n("el-form-item",{attrs:{label:e.typeMaps[e.form.type]+"图标",prop:"icon"}},[n("el-popover",{attrs:{placement:"bottom-start","popper-class":"p-menu__icon-popover",trigger:"click","append-to-body":!1},model:{value:e.iconVisible,callback:function(t){e.iconVisible=t},expression:"iconVisible"}},[e._l(e.svgIcons,(function(t){return n("span",{key:t,staticClass:"popover-icons",on:{click:function(n){return e.onHandleIcon(t)}}},[n("svg-icon",{staticClass:"popover-icon-item",attrs:{"icon-class":t}})],1)})),n("el-input",{attrs:{slot:"reference",placeholder:e.typeMaps[e.form.type]+"图标",clearable:""},slot:"reference",model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}},[e.form.icon?n("template",{slot:"append"},[n("svg-icon",{attrs:{"icon-class":e.form.icon}})],1):e._e()],2)],2)],1):e._e(),n("el-form-item",{attrs:{label:"上级"+e.typeMaps[(0===e.form.type?1:e.form.type)-1],prop:"pid"}},[n("el-popover",{ref:"menuListPopover",attrs:{trigger:"click",placement:"bottom-start"},model:{value:e.menuVisible,callback:function(t){e.menuVisible=t},expression:"menuVisible"}},[e.menuVisible?n("el-tree",{ref:"menuListTree",attrs:{data:e.menuList,props:{label:"name",children:"children"},"node-key":"id","default-expand-all":!0,"highlight-current":!0,"expand-on-click-node":!1},on:{"node-click":e.menuListTreeCurrentChangeHandle}}):e._e(),n("el-input",{attrs:{slot:"reference",placeholder:"上级"+e.typeMaps[(0===e.form.type?1:e.form.type)-1],clearable:""},on:{clear:e.onClearPid},slot:"reference",model:{value:e.form.parentName,callback:function(t){e.$set(e.form,"parentName",t)},expression:"form.parentName"}})],1)],1),n("el-form-item",{attrs:{label:"排序",prop:"sort"}},[n("el-input-number",{attrs:{min:0,placeholder:"排序"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}}),n("div",{staticClass:"notice"},[e._v("注：用于菜单栏展示顺序")])],1),2!==e.form.type?n("el-form-item",{attrs:{label:"是否显示",prop:"show"}},[n("el-radio-group",{model:{value:e.form.show,callback:function(t){e.$set(e.form,"show",t)},expression:"form.show"}},[n("el-radio",{attrs:{label:0}},[e._v("不显示")]),n("el-radio",{attrs:{label:1}},[e._v("显示")])],1),n("div",{staticClass:"notice"},[e._v("注：标识是否在侧边栏显示")])],1):e._e()],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.onFormSubmit()}}},[e._v(" "+e._s(e.$t("table.confirm"))+" ")]),n("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")])],1)],1)},s=[],c=(n("d9e2"),n("4de4"),n("caad"),n("2532"),n("159b"),n("b64b"),n("61f7")),u=n("ed08"),f=(n("ddb0"),n("d81d"),n("466d"),n("51ff")),d=function(e){return e.keys()},p=/\.\/(.*)\.svg/,m=d(f).map((function(e){return e.match(p)[1]})),b=m,h={name:"AddOrUpdate",data:function(){var e=function(e,t,n){Object(c["g"])(t)?n():n(new Error("只能是中英文"))};return{svgIcons:b,visible:!1,btnLoading:!1,iconVisible:!1,menuVisible:!1,form:{id:0,name:"",type:0,pid:0,url:"",alias:"",icon:"",show:1,sort:0,parentName:""},typeMaps:["目录","菜单","按钮"],menuRawList:[],rules:{name:[{required:!0,message:"名称不能为空",trigger:["blur","change"]},{validator:e,trigger:["blur","change"]}],alias:[{required:!0,message:"别名不能为空",trigger:["blur","change"]}]}}},computed:{menuList:{get:function(){var e=[[0],[0],[0,1]][this.form.type];return Object(u["d"])(this.menuRawList.filter((function(t){return e.includes(t.type)})),"id")}}},methods:{init:function(e,t){var n=this;this.visible=!0,this.onMenuList(t&&t.id).then((function(r){if(t&&t.pid){var a=e.filter((function(e){return e.id===t.pid}));n.form.parentName=a[0].name}}))},onMenuList:function(e){var t=this;return new Promise((function(n,r){Object(o["b"])().then((function(r){var a=r.data,i=void 0===a?[]:a,o=i.filter((function(t){return t.id===e}))[0];e&&Object.keys(t.form).forEach((function(e){t.form[e]=o[e]})),i=i.filter((function(t){return t.id!==e})),t.menuRawList=i,n()}))}))},menuListTreeCurrentChangeHandle:function(e){this.form.pid=e.id,this.form.parentName=e.name,this.menuVisible=!1},onFormSubmit:function(){var e=this;this.$refs["form"].validate((function(t){t&&(e.btnLoading=!0,Object(o["a"])(e.form).then((function(t){var n=t.msg;e.$message.success(n),e.visible=!1,e.$emit("refreshList")})).catch((function(){e.btnLoading=!1})))}))},onClearPid:function(){this.form.pid=0},onClose:function(){this.$reset()},onHandleIcon:function(e){this.form.icon=e,this.iconVisible=!1}}},v=h,g=(n("b48d"),n("2877")),y=Object(g["a"])(v,l,s,!1,null,"32f2cf64",null),k=y.exports,_={name:"Menu",components:{AddOrUpdate:k},data:function(){return{rawList:[],list:[],lists:[],search:{name:"",alias:""},loading:!1,addOrUpdateVisible:!1}},created:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading||(this.loading=t,Object(o["b"])(Object(i["a"])({},this.search)).then((function(t){0===t.code&&(e.rawList=t.data,e.list=Object(u["d"])(t.data,"id"),0===e.lists.length&&(e.lists=e.list))})).catch((function(){})).finally((function(){e.loading=!1})))},onAddOrUpdate:function(e,t){var n=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){n.$refs.addOrUpdate&&n.$refs.addOrUpdate.init(e,t)}))},onDelete:function(e){var t=this,n=e.name,r=e.id;this.$confirm("确定对[".concat(n,"(#").concat(r,")]进行[删除]操作?"),"删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",cancelButtonClass:"btn-custom-cancel"}).then((function(){Object(o["c"])(r).then((function(e){var n=e.msg,r=void 0===n?"删除成功":n;t.$message.success(r),t.init()})).catch((function(){}))})).catch((function(){}))}}},O=_,w=(n("45a6"),Object(g["a"])(O,r,a,!1,null,"e3ac3baa",null));t["default"]=w.exports}}]);