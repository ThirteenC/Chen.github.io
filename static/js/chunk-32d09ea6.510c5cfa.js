(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32d09ea6"],{"09f4":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),Math.easeInOutQuad=function(e,t,i,n){return e/=n/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function r(e,t){t?document.querySelector(t).scrollTop=e:(document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e)}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function a(e,t,i,a){var o=s(),l=e-o,u=20,c=0;t="undefined"===typeof t?500:t;var d=function e(){c+=u;var s=Math.easeInOutQuad(c,o,l,t);r(s,i),c<t?n(e):a&&"function"===typeof a&&a()};d()}},"15fd":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));i("a4d3"),i("b64b");function n(e,t){if(null==e)return{};var i,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}function r(e,t){if(null==e)return{};var i,r,s=n(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}},3800:function(e,t,i){"use strict";i.d(t,"h",(function(){return n})),i.d(t,"g",(function(){return r})),i.d(t,"j",(function(){return s})),i.d(t,"b",(function(){return a})),i.d(t,"l",(function(){return o})),i.d(t,"d",(function(){return l})),i.d(t,"k",(function(){return u})),i.d(t,"f",(function(){return c})),i.d(t,"e",(function(){return d})),i.d(t,"c",(function(){return p})),i.d(t,"a",(function(){return m})),i.d(t,"i",(function(){return f}));var n=[{label:"全部",value:""}],r=[{label:"全部",value:""},{label:"微信",value:"wxpay"},{label:"京东",value:"jdpay"},{label:"支付宝",value:"alipay"},{label:"银行卡",value:"bank"}],s=[{label:"全部",value:""},{label:"上架",value:0},{label:"下架",value:1}],a=[{label:"全部",value:""},{label:"通过",value:1,type:"success"},{label:"失败",value:2,type:"danger"}],o=[{label:"全部",value:""},{label:"否",value:0},{label:"是",value:1}],l=[{label:"一次性",value:"once",type:"warning"},{label:"长期",value:"long",type:"success"},{label:"指定藏品",value:"appoint",type:"primary"}],u=[{label:"全部",value:""},{label:"常规藏品",value:0,type:"primary"},{label:"盲盒藏品",value:1,type:"warning"},{label:"空投藏品",value:2,type:"primary"},{label:"合成藏品",value:3,type:"success"},{label:"资格券",value:5,type:"danger"},{label:"活动藏品",value:7,type:"danger"}],c=[{label:"全部",value:""},{label:"藏品订单",value:"goods",type:"primary"},{label:"盲盒订单",value:"box",type:"warning"}],d=[{label:"全部",value:""},{label:"待付款",value:0,type:"warning"},{label:"待发放",value:1,type:"primary"},{label:"已完成",value:2,type:"success"},{label:"已关闭",value:3,type:"info"},{label:"异常订单",value:4,type:"danger"}],p=[{label:"普通",value:0,type:"info"},{label:"3D",value:1,type:"primary"},{label:"视频",value:2,type:"warning"}],m=[{label:"指定藏品",value:"goods",type:"primary"},{label:"指定专区",value:"issuer",type:"warning"}],f={shortcuts:[{text:"最近24小时",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-864e5),e.$emit("pick",[i,t])}},{text:"最近一周",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e6),e.$emit("pick",[i,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-7776e6),e.$emit("pick",[i,t])}}]}},4059:function(e,t,i){"use strict";i("7c30")},"45d4":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{attrs:{inline:!0}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onAddOrUpdate()}}},[e._v(" "+e._s(e.$t("table.add"))+" ")])],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",data:e.list}},[i("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),i("el-table-column",{attrs:{label:"藏品信息","min-width":"300","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("div",{staticClass:"info-wrapper"},[i("el-image",{staticClass:"image-item",attrs:{src:n.goods&&n.goods.images.length>0&&e.domin+n.goods.images[0],"preview-src-list":[n.goods&&n.goods.images.length>0&&e.domin+n.goods.images[0]]}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])]),i("div",{staticStyle:{"margin-left":"10px"}},[i("div",[e._v("#"+e._s(n.goods.id||""))]),n.goods&&n.goods.name?i("div",[e._v(" 名称："+e._s(n.goods.name||"")+" ")]):e._e()])],1)]}}])}),i("el-table-column",{attrs:{label:"权益信息","min-width":"440","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("div",{staticClass:"interest",staticStyle:{display:"flex","overflow-x":"auto"}},e._l(n.interests,(function(t,n,r){return i("div",{key:r,staticStyle:{"margin-right":"10px","min-width":"200px","margin-bottom":"10px"}},[i("div",[e._v("权益名称： "),i("el-tag",{attrs:{type:"info",effect:"plain"}},[e._v(e._s(e._f("paraphrase")(n,e.keyOptions)))])],1),i("div",[e._v("权益类型： "),i("el-tag",{attrs:{type:e._f("paraphrase")(t.type,e.interestsOptions,"value","type")}},[e._v(e._s(e._f("paraphrase")(t.type,e.interestsOptions)))])],1),i("div",[e._v("权益次数： "+e._s(t.num))]),i("div",[e._v("是否销毁： "+e._s(1===t.is_destroy?"是":"否"))]),i("div",[e._v("权益时间： "+e._s(t.expire_time||"---"))])])})),0)]}}])}),i("el-table-column",{attrs:{prop:"intro",label:"权益描述","min-width":"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-tooltip",{attrs:{"popper-class":"popover-box",effect:"dark",content:n.intro,placement:"top"}},[i("div",{staticClass:"ellipsis"},[e._v(" "+e._s(n.intro)+" ")])])]}}])}),i("el-table-column",{attrs:{width:"140",prop:"created_at",label:"创建时间","header-align":"center"}}),i("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-button-group",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onAddOrUpdate(n)}}},[e._v("编辑")])],1)]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pages.total>0,expression:"pages.total > 0"}],attrs:{total:e.pages.total,page:e.pages.current,limit:e.pages.limit},on:{"update:page":function(t){return e.$set(e.pages,"current",t)},"update:limit":function(t){return e.$set(e.pages,"limit",t)},pagination:function(t){return e.getList()}}}),e.addOrUpdateVisible?i("add-or-update",{ref:"addOrUpdate",on:{refreshList:function(t){return e.getList()}}}):e._e()],1)},r=[],s=(i("d3b7"),i("8465")),a=i("5f87"),o=i("3800"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{width:"800px",top:"30px",title:e.form.id?e.$t("table.edit"):e.$t("table.add"),visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"180px","label-position":"left"}},[i("el-form-item",{attrs:{label:"藏品",prop:"goods_id"}},[i("el-select",{attrs:{filterable:"",clearable:"",disabled:!!e.form.id},model:{value:e.form.goods_id,callback:function(t){e.$set(e.form,"goods_id",t)},expression:"form.goods_id"}},e._l(e.interestGoodOptions,(function(t,n){return i("el-option",{key:n,attrs:{label:t.label,value:t.value}},[i("span",[e._v("#"+e._s(t.value))]),i("el-image",{staticClass:"good-img",attrs:{fit:"cover",src:t.image&&e.domin+t.image}}),i("span",[e._v(" "+e._s(t.label)+" ")])],1)})),1)],1),i("el-form-item",{attrs:{label:"权益说明",prop:"intro"}},[i("el-input",{attrs:{type:"textarea",rows:4,"show-word-limit":"",maxlength:"500",placeholder:"权益说明",clearable:""},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),i("el-form-item",{attrs:{label:"选择权益 (请勾选) ",prop:""}},[i("el-checkbox-group",{model:{value:e.checkLists,callback:function(t){e.checkLists=t},expression:"checkLists"}},e._l(e.priorOptions,(function(t,n){return i("el-checkbox",{key:n,attrs:{label:t.value,disabled:!!e.form.id&&!!e.oldCheckLists.find((function(e){return e===t.value}))},on:{change:function(i){return e.onChangeCheckItem(t)}}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),i("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-remove":e.onRemoveTab},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},e._l(e.checkLists,(function(t){return i("el-tab-pane",{key:t,attrs:{label:e.priorOptions.find((function(e){return e.value===t}))&&e.priorOptions.find((function(e){return e.value===t})).label,closable:!e.oldCheckLists.find((function(e){return e===t})),name:t}},[i("el-form-item",{attrs:{label:"权益类型",prop:"interests."+t+".type",rules:{required:!0,message:"请选择权益类型",trigger:"blur"}}},[i("el-select",{attrs:{clearable:"",disabled:!!e.form.id&&!!e.oldCheckLists.find((function(e){return e===t}))},on:{change:function(i){return e.onChangeType(t)}},model:{value:e.form.interests[t].type,callback:function(i){e.$set(e.form.interests[t],"type",i)},expression:"form.interests[item].type"}},e._l(e.priorItemOptions[t],(function(t,n){return i("el-option",{key:n,attrs:{label:e._f("paraphrase")(t.value,e.interestsOptions),value:t.value}})})),1)],1),!["rebate","give"].includes(t)&&"appoint"!==e.form.interests[t].type||"prior"!==t&&"once"===e.form.interests[t].type?i("el-form-item",{attrs:{label:"权益次数",prop:"interests."+t+".num",rules:{required:!0,message:"请输入权益次数",trigger:"blur"}}},[i("el-input-number",{attrs:{min:1,precision:0,label:"权益次数"},model:{value:e.form.interests[t].num,callback:function(i){e.$set(e.form.interests[t],"num",i)},expression:"form.interests[item].num"}})],1):e._e(),"prior"===t?i("el-form-item",{attrs:{label:"优先购提前时间(分)",prop:"interests."+t+".prior_time",rules:{required:!0,message:"请输入优先购时间",trigger:"blur"}}},[i("el-input-number",{attrs:{min:1,precision:0,label:"提前时间(分)"},model:{value:e.form.interests[t].prior_time,callback:function(i){e.$set(e.form.interests[t],"prior_time",i)},expression:"form.interests[item].prior_time"}})],1):e._e(),"give"===t?i("el-form-item",{attrs:{label:"藏品转赠解锁时间(天)",prop:"interests."+t+".give_days",rules:{required:!0,message:"请输入转赠时间",trigger:"blur"}}},[i("el-input-number",{attrs:{min:1,precision:0,label:"藏品转赠解锁时间(天)"},model:{value:e.form.interests[t].give_days,callback:function(i){e.$set(e.form.interests[t],"give_days",i)},expression:"form.interests[item].give_days"}})],1):e._e(),["rebate","give"].includes(t)&&"long"===e.form.interests[t].type?i("el-form-item",{attrs:{label:"是否开启"}},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.interests[t].num,callback:function(i){e.$set(e.form.interests[t],"num",i)},expression:"form.interests[item].num"}})],1):e._e(),["rebate","entity"].includes(t)?i("div",[i("el-form-item",{attrs:{label:"折扣",prop:"interests."+t+".discount",rules:{required:!0,message:"请输入折扣",trigger:["blur","change"]}}},[i("el-input-number",{attrs:{precision:0,min:1,max:100,placeholder:"请输入折扣"},model:{value:e.form.interests[t].discount,callback:function(i){e.$set(e.form.interests[t],"discount",i)},expression:"form.interests[item].discount"}})],1),i("div",{staticClass:"notice"},[e._v("注意：折扣范围 1-100 ，输入88代表8.8折")])],1):e._e(),"once"===e.form.interests[t].type?i("div",[i("el-form-item",{attrs:{label:"有效时间",prop:"interests."+t+".expire_time",rules:{required:!0,message:"请选择有效时间",trigger:"blur"}}},[i("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间","picker-options":e.pickerOptions0,align:"right"},model:{value:e.form.interests[t].expire_time,callback:function(i){e.$set(e.form.interests[t],"expire_time",i)},expression:"form.interests[item].expire_time"}})],1)],1):e._e(),"once"===e.form.interests[t].type?i("div",[i("el-form-item",{attrs:{label:"是否销毁",prop:"interests."+t+".is_destroy",rules:{required:!0,message:"请选择是否销毁",trigger:"blur"}}},[i("el-radio-group",{model:{value:e.form.interests[t].is_destroy,callback:function(i){e.$set(e.form.interests[t],"is_destroy",i)},expression:"form.interests[item].is_destroy"}},[i("el-radio",{attrs:{label:0}},[e._v("否")]),i("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1)],1):e._e(),"appoint"===e.form.interests[t].type?i("div",[i("el-form-item",{attrs:{label:"指定藏品",prop:"interests."+t+".buy.goods",rules:{validator:e.validateGoodAndBox,trigger:["blur","change"]}}},[i("el-select",{staticClass:"select-input",attrs:{filterable:"",multiple:"",clearable:""},model:{value:e.form.interests[t].buy.goods,callback:function(i){e.$set(e.form.interests[t].buy,"goods",i)},expression:"form.interests[item].buy.goods"}},e._l(e.goodsOptions,(function(t,n){return i("el-option",{key:n,attrs:{label:t.label,value:t.value}},[i("span",[e._v("#"+e._s(t.value))]),i("el-image",{staticClass:"good-img",attrs:{fit:"cover",src:t.image&&e.domin+t.image}}),i("span",[e._v(" "+e._s(t.label)+" ")])],1)})),1)],1),i("el-form-item",{attrs:{label:"指定盲盒",prop:"interests."+t+".buy.box",rules:{validator:e.validateGoodAndBox,trigger:["blur","change"]}}},[i("el-select",{staticClass:"select-input",attrs:{filterable:"",multiple:"",clearable:""},model:{value:e.form.interests[t].buy.box,callback:function(i){e.$set(e.form.interests[t].buy,"box",i)},expression:"form.interests[item].buy.box"}},e._l(e.boxOptions,(function(t,n){return i("el-option",{key:n,attrs:{label:t.label,value:t.value}},[i("span",[e._v("#"+e._s(t.value))]),i("el-image",{staticClass:"good-img",attrs:{fit:"cover",src:t.image&&e.domin+t.image}}),i("span",[e._v(" "+e._s(t.label)+" ")])],1)})),1)],1)],1):e._e()],1)})),1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.onFormSubmit()}}},[e._v(" "+e._s(e.$t("table.confirm"))+" ")]),i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")])],1)],1)],1)},u=[],c=(i("e9c4"),i("d81d"),i("b64b"),i("b0c0"),i("159b"),i("ac1f"),i("1276"),i("d9e2"),i("caad"),i("2532"),i("a434"),{name:"AddOrUpdate",data:function(){return{pickerOptions0:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},domin:Object(a["c"])(a["a"]),interestsOptions:o["d"],visible:!1,btnLoading:!1,interestGoodOptions:[],goodsOptions:[],boxOptions:[],priorOptions:[],priorItemOptions:{},checkLists:[],oldCheckLists:[],tabIndex:"",defaultItem:{type:"",num:1,expire_time:"",prior_time:1,give_days:1,is_destroy:0,discount:0,buy:{goods:[],box:[]}},box:0,goods:0,form:{id:0,goods_id:"",intro:"",interests:{}},rules:{goods_id:[{required:!0,message:"不能为空",trigger:["blur","change"]}],intro:[{required:!0,message:"不能为空",trigger:["blur","change"]}],is_destroy:[{required:!0,message:"请选择",trigger:["blur","change"]}]}}},methods:{init:function(e){var t;(this.visible=!0,this.interestLists(),this.goodsLists(e),e)&&(this.form=JSON.parse(JSON.stringify(e)),this.oldCheckLists=this.checkLists=Object.keys(this.form.interests).map((function(e){return e})),this.tabIndex=null!==(t=this.checkLists[this.checkLists.length-1])&&void 0!==t?t:"")},goodsLists:function(e){var t=this;Object(s["d"])().then((function(i){t.interestGoodOptions=i.data.interest_goods.map((function(e){return{label:e.name,value:e.id,image:e.images&&e.images[0]}})),t.goodsOptions=i.data.goods.map((function(e){return{label:e.name,value:e.id,image:e.images&&e.images[0]}})),t.boxOptions=i.data.box.map((function(e){return{label:e.name,value:e.id,image:e.images&&e.images[0]}})),e.goods_id&&t.interestGoodOptions.push({label:e.goods.name,value:e.goods.id})})).catch((function(){}))},interestLists:function(){var e=this;Object(s["f"])().then((function(t){Object.keys(t.data).forEach((function(i){e.priorOptions.push({label:t.data[i][0].name,value:i})})),Object.keys(t.data).forEach((function(i){e.priorItemOptions[i]=t.data[i].map((function(e){return{value:e.type}}))}))})).catch((function(){}))},validateGoodAndBox:function(e,t,i){0===this.form.interests[e.field.split(".")[1]].buy.goods.length&&0===this.form.interests[e.field.split(".")[1]].buy.box.length?i(new Error("指定藏品和指定盲盒必选一个")):i()},onChangeCheckItem:function(e){var t;this.checkLists.includes(e.value)?(this.$set(this.form.interests,e.value,JSON.parse(JSON.stringify(this.defaultItem))),this.tabIndex=e.value):(delete this.form.interests[e.value],this.tabIndex=null!==(t=this.checkLists[this.checkLists.length-1])&&void 0!==t?t:"")},onRemoveTab:function(e){var t,i=this;this.checkLists.forEach((function(t,n){t===e&&i.checkLists.splice(n,1)})),delete this.form.interests[e],this.tabIndex=null!==(t=this.checkLists[this.checkLists.length-1])&&void 0!==t?t:""},onChangeType:function(e){this.form.interests[e].buy.goods=[],this.form.interests[e].buy.box=[],"appoint"===this.form.interests[e].type&&(this.form.interests[e].num=1),"long"!==this.form.interests[e].type&&(this.form.interests[e].expire_time="")},onFormSubmit:function(){var e=this;this.$refs["form"].validate((function(t){t&&(e.btnLoading=!0,Object(s["b"])(e.form).then((function(t){var i=t.msg;e.$message.success(i),e.visible=!1,e.$emit("refreshList")})).catch((function(){e.btnLoading=!1})))}))},onClose:function(){this.$reset()}}}),d=c,p=(i("51e9"),i("2877")),m=Object(p["a"])(d,l,u,!1,null,"c0a9861a",null),f=m.exports,b=i("333d"),g={name:"Interest",components:{AddOrUpdate:f,Pagination:b["a"]},data:function(){return{domin:Object(a["c"])(a["a"]),loading:!1,pickerOptions:o["i"],interestsOptions:o["d"],keyOptions:[{label:"优先购",value:"prior"},{label:"转赠",value:"give"},{label:"零元购",value:"free_cny"},{label:"折扣购",value:"rebate"}],list:[],pages:{total:0,limit:20,current:1},addOrUpdateVisible:!1}},created:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pages.current,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loading||(this.loading=i,1===t&&(this.pages.current=t),Object(s["e"])({page:t,limit:this.pages.limit}).then((function(t){e.list=t.data.data,e.pages.total=t.data.total})).catch((function(){})).finally((function(){e.loading=!1})))},onAddOrUpdate:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate&&t.$refs.addOrUpdate.init(e)}))}}},v=g,h=(i("4059"),Object(p["a"])(v,n,r,!1,null,"0ab58a5e",null));t["default"]=h.exports},"51e9":function(e,t,i){"use strict";i("80f6")},"7c30":function(e,t,i){},"80f6":function(e,t,i){},8465:function(e,t,i){"use strict";i.d(t,"e",(function(){return o})),i.d(t,"b",(function(){return l})),i.d(t,"f",(function(){return u})),i.d(t,"d",(function(){return c})),i.d(t,"c",(function(){return d})),i.d(t,"a",(function(){return p}));var n=i("5530"),r=i("15fd"),s=i("b775"),a=["id"];function o(e){return s["a"].get("/interest/goods_interest",{params:e})}function l(e){var t=e.id,i=Object(r["a"])(e,a),n="POST",o="/interest/goods_interest";return t>0&&(n="PUT",o+="/".concat(t),i.id=t),Object(s["a"])({url:o,method:n,data:i})}function u(){return s["a"].get("/interest/goods_interest/interest/filter")}function c(){return s["a"].get("/interest/goods_interest/goods/filter")}function d(){return s["a"].get("/interest")}function p(e,t){return s["a"].put("/interest/".concat(e),Object(n["a"])({},t))}}}]);