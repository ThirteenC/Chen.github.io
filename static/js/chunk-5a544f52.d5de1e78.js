(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a544f52"],{"15fd":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("a4d3"),n("b64b");function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function a(e,t){if(null==e)return{};var n,a,i=r(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},"1f27":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("15fd"),a=n("b775"),i=["id"];function o(e){return a["a"].get("/menus",{params:e})}function s(e){var t=e.id,n=Object(r["a"])(e,i),o="POST",s="/menus";return t>0&&(o="PUT",s+="/".concat(t),n.id=t),Object(a["a"])({url:s,method:o,data:n})}function c(e){return a["a"].delete("/menus/".concat(e))}},"6c35":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-form",{attrs:{inline:!0,model:e.search}},[n("el-form-item",{attrs:{label:"名称"}},[n("el-input",{attrs:{placeholder:"名称",clearable:""},on:{clear:function(t){return e.getList(1)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(1)}},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),n("el-form-item",{attrs:{label:"别名"}},[n("el-input",{attrs:{placeholder:"别名",clearable:""},on:{clear:function(t){return e.getList(1)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(1)}},model:{value:e.search.alias,callback:function(t){e.$set(e.search,"alias",t)},expression:"search.alias"}})],1),n("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(t){return e.getList(1)}}},[e._v(" "+e._s(e.$t("table.search"))+" ")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onAddOrUpdate()}}},[e._v(" "+e._s(e.$t("table.add"))+" ")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"","highlight-current-row":"",data:e.list}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),n("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),n("el-table-column",{attrs:{prop:"alias",label:"别名",align:"center"}}),n("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onAddOrUpdate(r)}}},[e._v("编辑")]),n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.onDelete(r)}}},[e._v("删除")])]}}])})],1),e.addOrUpdateVisible?n("add-or-update",{ref:"addOrUpdate",on:{refreshList:function(t){return e.getList()}}}):e._e()],1)},a=[],i=n("5530"),o=(n("d3b7"),n("ac1f"),n("841c"),n("b0c0"),n("99af"),n("cc5e")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.form.id?e.$t("table.edit"):e.$t("table.add"),visible:e.visible},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-input",{attrs:{placeholder:"角色名称",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"别名",prop:"alias"}},[n("el-input",{attrs:{placeholder:"角色别名,请输入字母",clearable:""},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),n("el-form-item",{attrs:{label:"权限",prop:"permissions"}},[e.form.id>0?n("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"menu-tree",attrs:{"node-key":"id","show-checkbox":"",data:e.menuList,"default-expanded-keys":e.form.permissions,"check-on-click-node":!0,"expand-on-click-node":!1,props:{label:"name",children:"children"}}}):n("span",[e._v(" 请在新增角色成功后，通过「编辑」操作为新增角色添加「角色权限」 ")])],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.onFormSubmit()}}},[e._v(" "+e._s(e.$t("table.confirm"))+" ")]),n("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")])],1)],1)},c=[],l=n("2909"),u=(n("d9e2"),n("d81d"),n("159b"),n("caad"),n("2532"),n("61f7")),d=n("ed08"),f=n("1f27"),m={name:"AddOrUpdate",data:function(){var e=function(e,t,n){Object(u["g"])(t)?n():n(new Error("名称只能是中英文及数字"))};return{visible:!1,btnLoading:!1,treeLoading:!1,form:{id:0,name:"",alias:"",permissions:[]},menuList:[],rules:{name:[{required:!0,message:"名称不能为空",trigger:["blur","change"]},{validator:e,trigger:["blur","change"]}],alias:[{required:!0,message:"别名不能为空",trigger:["blur","change"]}]}}},methods:{init:function(e){this.visible=!0,this.getMenusHandle(),e&&(this.form=Object.assign({},e),this.form.permissions=e.permissions?e.permissions.map((function(e){var t=e.id;return t})).concat():[])},getMenusHandle:function(){var e=this;this.treeLoading||(this.treeLoading=!0,Object(f["b"])().then((function(t){var n=t.data;e.formatMenuData(n),e.treeLoading=!1})).catch((function(){e.treeLoading=!1})))},formatMenuData:function(e){this.menuList=Object(d["d"])(e).map((function(e){return"tenant"===e.alias?(e.children.forEach((function(t,n){e.children[n]=Object(i["a"])(Object(i["a"])({},t),{},{disabled:!0})})),Object(i["a"])(Object(i["a"])({},e),{},{disabled:!0})):e})),this.form.permissions&&this.form.permissions.length>0&&this.setCheckedKeys(this.filterFullCheckedKeys(this.menuList,this.form.permissions))},setCheckedKeys:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.$refs["menu-tree"].setCheckedKeys(e)},getAllCheckedKeys:function(){var e=this.$refs["menu-tree"];return[].concat(Object(l["a"])(e.getCheckedKeys()),Object(l["a"])(e.getHalfCheckedKeys()))},filterFullCheckedKeys:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return!n.length>0||e.forEach((function(e){var a=e.id,i=e.children;if(n.includes(a)){var o=Array.isArray(i)?i.length:0;o?t.filterFullCheckedKeys(i,n,r):r.push(a)}})),r},onFormSubmit:function(){var e=this;this.$refs["form"].validate((function(t){t&&(e.btnLoading=!0,e.form.id&&(e.form.permissions=e.getAllCheckedKeys()),Object(o["a"])(e.form).then((function(t){var n=t.msg;e.$message.success(n),e.visible=!1,e.$emit("refreshList")})).catch((function(){e.btnLoading=!1})))}))},onClose:function(){this.$reset()}}},h=m,b=n("2877"),p=Object(b["a"])(h,s,c,!1,null,"0ea072a5",null),g=p.exports,v={name:"Admin",components:{AddOrUpdate:g},data:function(){return{list:[],search:{name:"",alias:""},loading:!1,addOrUpdateVisible:!1}},created:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading||(this.loading=t,Object(o["b"])(Object(i["a"])({},this.search)).then((function(t){0===t.code&&(e.list=t.data)})).catch((function(){})).finally((function(){e.loading=!1})))},onAddOrUpdate:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate&&t.$refs.addOrUpdate.init(e)}))},onDelete:function(e){var t=this,n=e.name,r=e.id;this.$confirm("确定对[".concat(n,"(#").concat(r,")]进行[删除]操作?"),"删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error",cancelButtonClass:"btn-custom-cancel"}).then((function(){Object(o["c"])(r).then((function(e){var n=e.msg,r=void 0===n?"删除成功":n;t.$message.success(r),t.init()})).catch((function(){t.$message.error("删除失败")}))})).catch((function(){}))}}},O=v,k=Object(b["a"])(O,r,a,!1,null,null,null);t["default"]=k.exports},cc5e:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n("15fd"),a=n("b775"),i=["id"];function o(e){return a["a"].get("/roles",{params:e})}function s(e){var t=e.id,n=Object(r["a"])(e,i),o="POST",s="/roles";return t>0&&(o="PUT",s+="/".concat(t),n.id=t),Object(a["a"])({url:s,method:o,data:n})}function c(e){return a["a"].delete("/roles/".concat(e))}}}]);