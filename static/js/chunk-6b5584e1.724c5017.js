(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b5584e1"],{"0942":function(e,t,n){},"09f4":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),Math.easeInOutQuad=function(e,t,n,i){return e/=i/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function a(e,t){t?document.querySelector(t).scrollTop=e:(document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e)}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,n,r){var l=s(),o=e-l,c=20,u=0;t="undefined"===typeof t?500:t;var d=function e(){u+=c;var s=Math.easeInOutQuad(u,l,o,t);a(s,n),u<t?i(e):r&&"function"===typeof r&&r()};d()}},3123:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n("b775");function a(){return i["a"].get("/token")}},3800:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"j",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"l",(function(){return l})),n.d(t,"d",(function(){return o})),n.d(t,"k",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return p}));var i=[{label:"全部",value:""}],a=[{label:"全部",value:""},{label:"微信",value:"wxpay"},{label:"京东",value:"jdpay"},{label:"支付宝",value:"alipay"},{label:"银行卡",value:"bank"}],s=[{label:"全部",value:""},{label:"上架",value:0},{label:"下架",value:1}],r=[{label:"全部",value:""},{label:"通过",value:1,type:"success"},{label:"失败",value:2,type:"danger"}],l=[{label:"全部",value:""},{label:"否",value:0},{label:"是",value:1}],o=[{label:"一次性",value:"once",type:"warning"},{label:"长期",value:"long",type:"success"},{label:"指定藏品",value:"appoint",type:"primary"}],c=[{label:"全部",value:""},{label:"常规藏品",value:0,type:"primary"},{label:"盲盒藏品",value:1,type:"warning"},{label:"空投藏品",value:2,type:"primary"},{label:"合成藏品",value:3,type:"success"},{label:"资格券",value:5,type:"danger"},{label:"活动藏品",value:7,type:"danger"}],u=[{label:"全部",value:""},{label:"藏品订单",value:"goods",type:"primary"},{label:"盲盒订单",value:"box",type:"warning"}],d=[{label:"全部",value:""},{label:"待付款",value:0,type:"warning"},{label:"待发放",value:1,type:"primary"},{label:"已完成",value:2,type:"success"},{label:"已关闭",value:3,type:"info"},{label:"异常订单",value:4,type:"danger"}],m=[{label:"普通",value:0,type:"info"},{label:"3D",value:1,type:"primary"},{label:"视频",value:2,type:"warning"}],f=[{label:"指定藏品",value:"goods",type:"primary"},{label:"指定专区",value:"issuer",type:"warning"}],p={shortcuts:[{text:"最近24小时",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-864e5),e.$emit("pick",[n,t])}},{text:"最近一周",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.$emit("pick",[n,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.$emit("pick",[n,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.$emit("pick",[n,t])}}]}},"528e":function(e,t,n){"use strict";n("fff2")},"72bc":function(e,t,n){"use strict";var i=n("d4ec"),a=n("bee2"),s=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("b0c0"),n("ac1f"),n("1276"),n("b680"),function(){function e(t,n){return Object(i["a"])(this,e),this.video=document.createElement("video"),this.video.preload="metadata",this.video.src=URL.createObjectURL(t),this.init(t,n)}return Object(a["a"])(e,[{key:"init",value:function(e,t){var n=this;return new Promise((function(i){var a=n.fileLengthFormat(e.size,t),s=n.getFileType(e.name);"mp4"===s?n.video.onloadedmetadata=function(){window.URL.revokeObjectURL(n.video.src);var e=n.video.duration;i({fileSize:a,duration:e,type:s,height:n.video.videoHeight,width:n.video.videoWidth})}:i({fileSize:a,duration:0,type:s,height:n.video.videoHeight,width:n.video.videoWidth})}))}},{key:"getFileType",value:function(e){var t=e.split("."),n="";return void 0!==t&&(t.length<=1&&e.indexOf("=")>-1?(console.log("输入是文件地址：",t),!1):(n=t[t.length-1],n=n.toLowerCase(),n))}},{key:"fileLengthFormat",value:function(e,t){var n,i=e/1024;if(i>1e3)return this.fileLengthFormat(i,++t);switch(t){case 1:n=i.toFixed(2);break;case 2:n=i.toFixed(2);break;case 3:n=i.toFixed(2);break;case 4:n=i.toFixed(2);break}return+n}}]),e}());t["a"]=s},8075:function(e,t,n){"use strict";n("0942")},"8925e":function(e,t,n){e.exports=n.p+"static/img/favicon.2419b6b6.png"},a7e0:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-form",{attrs:{inline:!0,model:e.search}},[n("el-form-item",{attrs:{label:"账号"}},[n("el-input",{attrs:{placeholder:"ID/昵称/手机号",clearable:""},on:{clear:function(t){return e.getList(1)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList(1)}},model:{value:e.search.keywords,callback:function(t){e.$set(e.search,"keywords",t)},expression:"search.keywords"}})],1),n("el-form-item",{attrs:{label:"状态"}},[n("el-radio-group",{on:{change:function(t){return e.getList(1)}},model:{value:e.search.status,callback:function(t){e.$set(e.search,"status",t)},expression:"search.status"}},e._l(e.statusOptions,(function(t){return n("el-badge",{key:t.value,staticClass:"badge-item"},[n("el-radio-button",{attrs:{label:t.value}},[e._v(e._s(t.label))])],1)})),1)],1),n("el-form-item",{attrs:{label:"时间"}},[n("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},on:{change:e.onChangeDateRange},model:{value:e.dateRangeValue,callback:function(t){e.dateRangeValue=t},expression:"dateRangeValue"}})],1),n("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(t){return e.getList(1)}}},[e._v(" "+e._s(e.$t("table.search"))+" ")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"","highlight-current-row":"",data:e.list}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),n("el-table-column",{attrs:{label:"用户信息",width:"200","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.user?n("div",[n("el-avatar",{key:i.user.id,staticStyle:{"vertical-align":"top"},attrs:{icon:"el-icon-user-solid",src:i.user.avatar?e.domin+i.user.avatar:""}}),n("div",{staticStyle:{display:"inline-block","margin-left":"2px"}},[n("div",[e._v(" "+e._s(i.user.name)+" "),i.user.certification?n("span",[n("el-divider",{attrs:{direction:"vertical"}}),n("el-tag",{attrs:{effect:"plain"}},[e._v(e._s(i.user.certification.name))])],1):e._e()]),n("div",[e._v(" "+e._s(i.user.phone||i.user.email)+" ")])])],1):n("div",[e._v(" 用户已删除 ")])]}}])}),n("el-table-column",{attrs:{prop:"content",label:"反馈内容","min-width":"200","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,a=t.$index;return[n("div",{staticClass:"RichContent-collapsedText",class:{ellipsis:i.ellipsis}},[e._v(" "+e._s(i.content)+" "),n("div",{staticClass:"RichContent-lookText",on:{click:function(t){return e.onLookAll(a)}}},[e._v(" "+e._s(i.ellipsis?"查看全部":"收起内容")+" ")])])]}}])}),n("el-table-column",{attrs:{prop:"images",label:"反馈图片",width:"365","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,a=t.$index;return[e.loading?e._e():n("div",{staticClass:"recommend-page"},[n("swiper",{ref:"mySwiper"+a,attrs:{options:e.swiperOption}},e._l(i.images,(function(t,i){return n("swiper-slide",{key:i,staticClass:"images-list"},[n("el-image",{staticClass:"image-item",attrs:{fit:"contain",src:t.filename&&e.domin+t.filename},on:{click:function(n){return e.onPicturePreview(t)}}})],1)})),1),i.images.length>3?n("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},on:{click:function(t){return e.prev(a)}},slot:"button-prev"}):e._e(),i.images.length>3?n("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},on:{click:function(t){return e.next(a)}},slot:"button-next"}):e._e()],1)]}}])}),n("el-table-column",{attrs:{label:"联系方式",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.user?n("div",[e._v(" "+e._s(i.user.phone||i.user.email)+" ")]):n("div",[e._v(" - ")])]}}])}),n("el-table-column",{attrs:{prop:"from",label:"来源",width:"80",align:"center"}}),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row.status;return[0===i?n("el-tag",{attrs:{type:"warning"}},[e._v("未解决")]):n("el-tag",{attrs:{type:"success"}},[e._v("已解决")])]}}])}),n("el-table-column",{attrs:{prop:"created_at",width:"140",label:"反馈时间",align:"center"}}),n("el-table-column",{attrs:{width:"150",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onJwChatTalk(i)}}},[e._v("回复")]),0===i.status?n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.onSolve(i)}}},[e._v("解决")]):e._e()]}}])})],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pages.total>0,expression:"pages.total > 0"}],attrs:{total:e.pages.total,page:e.pages.current,limit:e.pages.limit},on:{"update:page":function(t){return e.$set(e.pages,"current",t)},"update:limit":function(t){return e.$set(e.pages,"limit",t)},pagination:function(t){return e.getList()}}}),e.talkVisible?n("jw-chat-talk",{ref:"talk",on:{refreshList:function(t){return e.getList()}}}):e._e(),e.imageViewer?n("el-image-viewer",{attrs:{"on-close":e.closeViewer,"url-list":e.imageViewerList}}):e._e()],1)},a=[],s=n("5530"),r=(n("d3b7"),n("ac1f"),n("841c"),n("d81d"),n("333d")),l=n("15fd"),o=n("b775"),c=["id"];function u(e){return o["a"].get("/feedback",{params:e})}function d(e,t){return o["a"].get("/feedback/".concat(e,"/detail"),{params:t})}function m(e){var t=e.id,n=Object(l["a"])(e,c);return o["a"].post("/feedback/".concat(t,"/reply"),Object(s["a"])({},n))}function f(e){return o["a"].patch("/feedback/".concat(e,"/solve"))}var p=n("5f87"),g=n("3800"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"",visible:e.visible},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[n("JwChat",{attrs:{"tale-list":e.list,"tool-config":e.tool,"scroll-type":"scroll"},on:{enter:e.bindEnter},model:{value:e.inputMsg,callback:function(t){e.inputMsg=t},expression:"inputMsg"}}),n("div",{staticClass:"up-img"},e._l(e.sendImgs,(function(t,i){return n("div",{key:i,staticClass:"img-box"},[n("i",{staticClass:"el-icon-close close",on:{click:function(t){return e.onCloseImg(i)}}}),n("el-image",{staticClass:"img-item",attrs:{src:t.filename&&e.domin+t.filename,fit:"cover","preview-src-list":[e.domin+t.filename]}})],1)})),0),n("div",{staticStyle:{display:"none"}},[n("custom-upload",{attrs:{"class-name":"up_uploader"},on:{handleBeforeUpload:e.beforeAvatarUpload,handleSuccess:e.handleAvatarSuccess}})],1)],1)},v=[],b=(n("b0c0"),n("159b"),n("a434"),n("caad"),n("a15b"),n("2f62")),w=n("0eef"),y={name:"JwChatTalk",components:{CustomUpload:w["a"]},data:function(){return{domin:Object(p["c"])(p["a"]),visible:!1,btnLoading:!1,inputMsg:"",list:[],sendImgs:[],tool:{show:["img"],showEmoji:!1,callback:this.toolEvent},minAvatar:n("8925e"),form:{id:0,user:{},content:"",created_at:"",images:[]}}},computed:Object(s["a"])({},Object(b["b"])(["info"])),methods:{init:function(e){var t=this;this.visible=!0,e&&(this.form=e,this.list.push(this.tem(this.form.created_at,!1,this.form.user.name,this.avatar("user"),this.form.content)),this.form.images&&this.form.images.length&&this.form.images.forEach((function(e){t.list.push(t.tem(t.form.created_at,!1,t.form.user.name,t.avatar("user"),e,"img"))})),this.getList())},getList:function(){var e=this;d(this.form.id).then((function(t){t.data.forEach((function(t){e.list.push(e.tem(t.created_at,"user"!==t.type,e.form.user.name,e.avatar(t.type),t.content)),t.images.length>0&&t.images.forEach((function(n){e.list.push(e.tem(t.created_at,"user"!==t.type,e.form.user.name,e.avatar(t.type),n,"img"))}))}))})).catch((function(){})).finally((function(){}))},getImageDetail:function(){var e=this,t=document.getElementsByClassName("img-item");t.forEach((function(t,n){var i=e.sendImgs[n].filename.lastIndexOf("."),a=new Image;a.src=e.domin+e.sendImgs[n].filename,e.sendImgs[n]={filename:e.sendImgs[n].filename,height:a.height,width:a.width,mime:e.sendImgs[n].filename.substr(i+1)}}))},bindEnter:function(e){var t=this;this.getImageDetail();var i=this.inputMsg;if(!i)return this.$message.error("必须输入回复"),!1;var a=[];this.sendImgs.forEach((function(e,n){var i=t.sendImgs[n].filename.lastIndexOf("."),s=new Image;s.src=t.domin+t.sendImgs[n].filename,t.sendImgs[n]={filename:t.sendImgs[n].filename,height:s.height,width:s.width,mime:t.sendImgs[n].filename.substr(i+1)},a.push(t.sendImgs[n])})),this.$confirm("确定进行回复操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){m({id:t.form.id,content:i,images:a}).then((function(e){var i=e.data,a=e.msg,s=void 0===a?"跟进成功":a;t.sendImgs=[],t.list.push(t.tem(i.created_at,!0,t.info.name,n("8925e"),i.content)),i.images.length>0&&i.images.forEach((function(e){t.list.push(t.tem(i.created_at,!0,t.info.name,n("8925e"),e,"img"))})),t.$message.success(s)})).catch((function(){t.inputMsg=i}))})).catch((function(){t.inputMsg=i}))},onClose:function(){this.$reset("data",!1)},tem:function(e,t,n,i,a,s){var r;return r="img"===s?a&&a.filename?"<img data-src='".concat(this.domin+a.filename,"' />"):"<img data-src='".concat(this.domin+a,"' />"):a,{date:e,mine:t,name:n,img:i,text:{text:r}}},avatar:function(e){return"user"===e?this.form.user.avatar?this.domin+this.form.user.avatar:n("8925e"):"system"===e?n("8925e"):""},toolEvent:function(e,t){"img"===e&&(this.sendImgs.length<3?document.querySelector(".up_uploader input").click():this.$message.error("最多上传3张图片"))},onCloseImg:function(e){this.sendImgs.splice(e,1)},handleAvatarSuccess:function(e,t){this.sendImgs.push({filename:e.name,height:0,width:0,mime:""})},beforeAvatarUpload:function(e,t){var n=["image/jpeg","image/jpg","image/png","image/gif"],i=e.size/1024/1024<20;return n.includes(e.type)?i?void t(!0):(this.$message.error("上传图片大小不能超过 20M"),void t(!1)):(this.$message.error("上传图片只能是 "+n.join(",")+" 格式!"),void t(!1))}}},k=y,_=(n("8075"),n("2877")),x=Object(_["a"])(k,h,v,!1,null,"acd8f772",null),C=x.exports,I=n("08a9"),T=n("7212"),O=(n("bbe3"),{name:"Feedback",components:{Pagination:r["a"],JwChatTalk:C,ElImageViewer:I["a"],Swiper:T["Swiper"],SwiperSlide:T["SwiperSlide"]},data:function(){return{domin:Object(p["c"])(p["a"]),list:[],search:{keywords:"",status:"",start_time:"",end_time:""},pages:{total:0,limit:20,current:1},statusOptions:[{label:"全部",value:""},{label:"未解决",value:0},{label:"已解决",value:1}],swiperOption:{slidesPerView:3,spaceBetween:10,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},imageViewer:!1,imageViewerList:[],dateRangeValue:[],pickerOptions:g["i"],loading:!1,talkVisible:!1}},computed:{swiper:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.$refs["mySwiper".concat(e)].$swiper}}},created:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pages.current,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loading||(this.loading=n,1===t&&(this.pages.current=t),u(Object(s["a"])(Object(s["a"])({page:t},this.search),{},{limit:this.pages.limit})).then((function(t){0===t.code&&(e.list=t.data.data.map((function(e){return Object.assign(e,{ellipsis:!0})})),e.pages.total=t.data.total)})).catch((function(){})).finally((function(){e.loading=!1})))},onChangeDateRange:function(e){Array.isArray(e)?(this.search.start_time=e[0],this.search.end_time=e[1]):(this.search.start_time=this.search.end_time="",this.getList(1))},onJwChatTalk:function(e){var t=this;this.talkVisible=!0,this.$nextTick((function(){t.$refs.talk&&t.$refs.talk.init(e)}))},onPicturePreview:function(e){this.imageViewerList=[this.domin+e.filename],this.imageViewer=!0},closeViewer:function(){this.imageViewer=!1},prev:function(e){this.swiper(e).slidePrev()},next:function(e){this.swiper(e).slideNext()},onSolve:function(e){var t=this;this.$confirm("确定进行设置解决操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){f(e.id).then((function(e){var n=e.msg;t.getList(),t.$message.success(n)})).catch((function(){}))})).catch((function(){}))},onLookAll:function(e){this.list[e].ellipsis?this.list[e].ellipsis=!1:this.list[e].ellipsis=!0}}}),L=O,$=(n("528e"),Object(_["a"])(L,i,a,!1,null,"2bafc46a",null));t["default"]=$.exports},fff2:function(e,t,n){}}]);