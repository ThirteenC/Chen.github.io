(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75a0d389"],{"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function r(e,t){t?document.querySelector(t).scrollTop=e:(document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e)}function i(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,a,o){var l=i(),s=e-l,c=20,u=0;t="undefined"===typeof t?500:t;var d=function e(){u+=c;var i=Math.easeInOutQuad(u,l,s,t);r(i,a),u<t?n(e):o&&"function"===typeof o&&o()};d()}},"15fd":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("a4d3"),a("b64b");function n(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}function r(e,t){if(null==e)return{};var a,r,i=n(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}},3123:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("b775");function r(){return n["a"].get("/token")}},3800:function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"g",(function(){return r})),a.d(t,"j",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"l",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"k",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return f})),a.d(t,"a",(function(){return p})),a.d(t,"i",(function(){return m}));var n=[{label:"全部",value:""}],r=[{label:"全部",value:""},{label:"微信",value:"wxpay"},{label:"京东",value:"jdpay"},{label:"支付宝",value:"alipay"},{label:"银行卡",value:"bank"}],i=[{label:"全部",value:""},{label:"上架",value:0},{label:"下架",value:1}],o=[{label:"全部",value:""},{label:"通过",value:1,type:"success"},{label:"失败",value:2,type:"danger"}],l=[{label:"全部",value:""},{label:"否",value:0},{label:"是",value:1}],s=[{label:"一次性",value:"once",type:"warning"},{label:"长期",value:"long",type:"success"},{label:"指定藏品",value:"appoint",type:"primary"}],c=[{label:"全部",value:""},{label:"常规藏品",value:0,type:"primary"},{label:"盲盒藏品",value:1,type:"warning"},{label:"空投藏品",value:2,type:"primary"},{label:"合成藏品",value:3,type:"success"},{label:"资格券",value:5,type:"danger"},{label:"活动藏品",value:7,type:"danger"}],u=[{label:"全部",value:""},{label:"藏品订单",value:"goods",type:"primary"},{label:"盲盒订单",value:"box",type:"warning"}],d=[{label:"全部",value:""},{label:"待付款",value:0,type:"warning"},{label:"待发放",value:1,type:"primary"},{label:"已完成",value:2,type:"success"},{label:"已关闭",value:3,type:"info"},{label:"异常订单",value:4,type:"danger"}],f=[{label:"普通",value:0,type:"info"},{label:"3D",value:1,type:"primary"},{label:"视频",value:2,type:"warning"}],p=[{label:"指定藏品",value:"goods",type:"primary"},{label:"指定专区",value:"issuer",type:"warning"}],m={shortcuts:[{text:"最近24小时",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-864e5),e.$emit("pick",[a,t])}},{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}},"459f":function(e,t,a){},"72bc":function(e,t,a){"use strict";var n=a("d4ec"),r=a("bee2"),i=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("b0c0"),a("ac1f"),a("1276"),a("b680"),function(){function e(t,a){return Object(n["a"])(this,e),this.video=document.createElement("video"),this.video.preload="metadata",this.video.src=URL.createObjectURL(t),this.init(t,a)}return Object(r["a"])(e,[{key:"init",value:function(e,t){var a=this;return new Promise((function(n){var r=a.fileLengthFormat(e.size,t),i=a.getFileType(e.name);"mp4"===i?a.video.onloadedmetadata=function(){window.URL.revokeObjectURL(a.video.src);var e=a.video.duration;n({fileSize:r,duration:e,type:i,height:a.video.videoHeight,width:a.video.videoWidth})}:n({fileSize:r,duration:0,type:i,height:a.video.videoHeight,width:a.video.videoWidth})}))}},{key:"getFileType",value:function(e){var t=e.split("."),a="";return void 0!==t&&(t.length<=1&&e.indexOf("=")>-1?(console.log("输入是文件地址：",t),!1):(a=t[t.length-1],a=a.toLowerCase(),a))}},{key:"fileLengthFormat",value:function(e,t){var a,n=e/1024;if(n>1e3)return this.fileLengthFormat(n,++t);switch(t){case 1:a=n.toFixed(2);break;case 2:a=n.toFixed(2);break;case 3:a=n.toFixed(2);break;case 4:a=n.toFixed(2);break}return+a}}]),e}());t["a"]=i},"7e12":function(e,t,a){var n=a("da84"),r=a("d039"),i=a("e330"),o=a("577e"),l=a("58a8").trim,s=a("5899"),c=i("".charAt),u=n.parseFloat,d=n.Symbol,f=d&&d.iterator,p=1/u(s+"-0")!==-1/0||f&&!r((function(){u(Object(f))}));e.exports=p?function(e){var t=l(o(e)),a=u(t);return 0===a&&"-"==c(t,0)?-0:a}:u},8289:function(e,t,a){"use strict";a("459f")},"857a":function(e,t,a){var n=a("e330"),r=a("1d80"),i=a("577e"),o=/"/g,l=n("".replace);e.exports=function(e,t,a,n){var s=i(r(e)),c="<"+t;return""!==a&&(c+=" "+a+'="'+l(i(n),o,"&quot;")+'"'),c+">"+s+"</"+t+">"}},9911:function(e,t,a){"use strict";var n=a("23e7"),r=a("857a"),i=a("af03");n({target:"String",proto:!0,forced:i("link")},{link:function(e){return r(this,"a","href",e)}})},"9fe8":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[e._v(" 版本控制状态 "),a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:e.onChangeStatus},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}}),a("el-divider"),e.status?a("div",[a("div",{staticClass:"filter-container"},[a("el-form",{attrs:{inline:!0,model:e.search}},[e._e(),e._e(),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onAddOrUpdate()}}},[e._v(" "+e._s(e.$t("table.add"))+" ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"","highlight-current-row":"",data:e.list}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"版本类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.type>=0&&e.typeOptions[a.type+1].label)+" ")]}}],null,!1,2945725748)}),a("el-table-column",{attrs:{prop:"version_name",label:"版本名称",align:"center"}}),a("el-table-column",{attrs:{prop:"version_code",label:"内部版本号",align:"center"}}),a("el-table-column",{attrs:{prop:"description",label:"版本说明",align:"center"}}),a("el-table-column",{attrs:{prop:"link",label:"链接地址",align:"center"}}),a("el-table-column",{attrs:{prop:"is_forced",label:"是否强制更新",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.is_forced>=0&&e.forcedOptions[a.is_forced+1].label)+" ")]}}],null,!1,1353178229)}),a("el-table-column",{attrs:{prop:"created_at",label:"发送时间",align:"center"}})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pages.total>0,expression:"pages.total > 0"}],attrs:{total:e.pages.total,page:e.pages.current,limit:e.pages.limit},on:{"update:page":function(t){return e.$set(e.pages,"current",t)},"update:limit":function(t){return e.$set(e.pages,"limit",t)},pagination:function(t){return e.getList()}}}),e.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate",on:{refreshList:function(t){return e.getList(1)}}}):e._e()],1):e._e()],1)},r=[],i=a("5530"),o=(a("d3b7"),a("ac1f"),a("841c"),a("333d")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.form.id?e.$t("table.edit"):e.$t("table.add"),visible:e.visible},on:{"update:visible":function(t){e.visible=t},closed:function(t){return e.onClose()}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"版本类型",prop:"type"}},[a("el-radio-group",{on:{change:e.onSelectType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-radio",{attrs:{label:0}},[e._v("android")]),a("el-radio",{attrs:{label:1}},[e._v("ios")])],1)],1),a("el-form-item",{attrs:{label:"版本名称",prop:"version_name"}},[a("el-input",{attrs:{placeholder:"版本名称",clearable:""},model:{value:e.form.version_name,callback:function(t){e.$set(e.form,"version_name",t)},expression:"form.version_name"}})],1),a("el-form-item",{attrs:{label:"内部版本号",prop:"version_code"}},[a("el-input",{attrs:{placeholder:"内部版本号",clearable:""},model:{value:e.form.version_code,callback:function(t){e.$set(e.form,"version_code",t)},expression:"form.version_code"}})],1),a("el-form-item",{attrs:{label:"更新说明",prop:"description"}},[a("el-input",{attrs:{type:"textarea",placeholder:"更新说明",clearable:""},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:"上传APP包",prop:"link"}},[a("custom-upload",{attrs:{"class-name":"","show-file-list":!0,limit:1,"file-list":e.fileList},on:{handleBeforeUpload:e.beforeAvatarUpload,handleSuccess:e.handleAvatarSuccess,handleExceed:e.handleExceed,elProgress:e.elProgress}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")])],1),[0,1].includes(e.percentage)?e._e():a("el-progress",{attrs:{percentage:100*e.percentage}})],1),a("el-form-item",{attrs:{label:"是否强制更新",prop:"is_forced"}},[a("el-radio-group",{model:{value:e.form.is_forced,callback:function(t){e.$set(e.form,"is_forced",t)},expression:"form.is_forced"}},[a("el-radio",{attrs:{label:0}},[e._v("否")]),a("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.onFormSubmit()}}},[e._v(" "+e._s(e.$t("table.confirm"))+" ")]),a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")])],1)],1)},s=[],c=(a("d9e2"),a("9911"),a("c35a"),a("a9e3"),a("b680"),a("b0c0"),a("61f7")),u=a("5f87"),d=a("15fd"),f=a("b775"),p=["id"];function m(e){return f["a"].get("/versions",{params:e})}function b(e){var t=e.id,a=Object(d["a"])(e,p),n="POST",r="/versions";return t>0&&(n="PUT",r+="/".concat(t),a.id=t),Object(f["a"])({url:r,method:n,data:a})}var v=a("0eef"),g={name:"AddOrUpdate",components:{CustomUpload:v["a"]},data:function(){var e=function(e,t,a){Object(c["e"])(t)?a():a(new Error("内部版本号必须是整数"))};return{visible:!1,btnLoading:!1,domin:Object(u["c"])(u["a"]),percentage:0,form:{type:0,version_name:"",version_code:"",description:"",link:"",is_forced:0},fileList:[],rules:{type:[{required:!0,message:"请选择版本类型",trigger:"blur"}],version_name:[{required:!0,message:"版本名称不能为空",trigger:"blur"}],version_code:[{required:!0,message:"内部版本号不能为空",trigger:"blur"},{validator:e,trigger:"blur"}],link:[{required:!0,message:"下载链接不能为空",trigger:"blur"}],description:[{required:!0,message:"更新说明不能为空",trigger:"blur"}],is_forced:[{required:!0,message:"请选择是否强制更新",trigger:"blur"}]}}},methods:{init:function(e){this.visible=!0,e&&(this.form=Object.assign({},e))},onFormSubmit:function(){var e=this;this.$refs["form"].validate((function(t){t&&(e.btnLoading=!0,b(e.form).then((function(t){var a=t.msg;e.$message.success(a),e.visible=!1,e.$emit("refreshList")})).catch((function(){e.btnLoading=!1})))}))},onSelectType:function(e){this.form.link="",this.fileList=[]},clearForm:function(){this.form={type:0,version_name:"",version_code:"",description:"",link:"",is_forced:0}},onClose:function(){this.btnLoading=!1,this.clearForm(),this.$refs["form"].resetFields(),this.fileList=[]},elProgress:function(e,t,a){this.percentage=Number.parseFloat(e.toFixed(2))},handleAvatarSuccess:function(e,t){this.form.link=e.name,this.fileList=[{name:e.name,url:e.name}]},beforeAvatarUpload:function(e,t){this.form.type||-1!==e.type.indexOf("android")?this.form.type&&-1===e.name.indexOf("ipa")?(this.$message.error("请上传苹果ipa文件"),t(!1)):t(!0):(this.$message.error("请上传安卓apk文件"),t(!1))},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，请删除后在上传")}}},h=g,y=(a("8289"),a("2877")),_=Object(y["a"])(h,l,s,!1,null,"5f5de834",null),w=_.exports,k=a("4d2d"),O=a("3800"),x={name:"Version",components:{Pagination:o["a"],AddOrUpdate:w},data:function(){return{domin:Object(u["c"])(u["a"]),status:0,list:[],search:{start:"",end:""},pages:{total:0,limit:20,current:1},typeOptions:[{label:"全部",value:""},{label:"android",value:0},{label:"ios",value:1}],forcedOptions:[{label:"全部",value:""},{label:"否",value:0},{label:"是",value:1}],dateRangeValue:[],pickerOptions:O["i"],loading:!1,addOrUpdateVisible:!1}},created:function(){this.init()},methods:{init:function(){this.getStatus()},getStatus:function(){var e=this;Object(k["K"])().then((function(t){e.status=t.data.value,1===t.data.value&&e.getList()})).catch((function(){}))},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pages.current,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loading||(this.loading=a,1===t&&(this.pages.current=t),m(Object(i["a"])(Object(i["a"])({page:t},this.search),{},{limit:this.pages.limit})).then((function(t){0===t.code&&(e.list=t.data.data,e.pages.total=t.data.total)})).catch((function(t){e.$message.error(t.msg)})).finally((function(){e.loading=!1})))},onAddOrUpdate:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick((function(){t.$refs.addOrUpdate&&t.$refs.addOrUpdate.init(e)}))},onChangeDateRange:function(e){Array.isArray(e)?(this.search.start=e[0],this.search.end=e[1]):(this.search.start="",this.search.end="",this.getList(1))},onChangeStatus:function(e){var t=this;Object(k["F"])({status:e}).then((function(e){t.getStatus()})).catch((function(e){t.$message.error(e.msg)}))}}},$=x,L=Object(y["a"])($,n,r,!1,null,null,null);t["default"]=L.exports},af03:function(e,t,a){var n=a("d039");e.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},c35a:function(e,t,a){var n=a("23e7"),r=a("7e12");n({target:"Number",stat:!0,forced:Number.parseFloat!=r},{parseFloat:r})}}]);